<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta name="description" content="Keep coding">
<meta property="og:type" content="website">
<meta property="og:title" content="Forwards">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="Forwards">
<meta property="og:description" content="Keep coding">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Forwards">
<meta name="twitter:description" content="Keep coding">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/"/>





  <title>Forwards</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Forwards</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">有空的博客</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/11/05/Appium入坑指南——第一个测试用例（Python篇）/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Forwards">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Forwards">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/11/05/Appium入坑指南——第一个测试用例（Python篇）/" itemprop="url">Appium入坑指南——第一个测试用例（Python篇）</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-11-05T22:34:43+08:00">
                2018-11-05
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="安装Appium-Python-Client"><a href="#安装Appium-Python-Client" class="headerlink" title="安装Appium Python Client"></a>安装Appium Python Client</h1><p>三种安装方式：</p>
<ol>
<li><p>pip在线安装（推荐方式）：<code>pip install Appium-Python-Client</code></p>
</li>
<li><p>在Pypi上<a href="https://pypi.org/project/Appium-Python-Client/#files" target="_blank" rel="noopener">下载源码安装</a></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">tar -xvf Appium-Python-Client-X.X.tar.gz</span><br><span class="line">cd Appium-Python-Client-X.X</span><br><span class="line">sudo python3.6 setup.py install</span><br></pre></td></tr></table></figure>
</li>
<li><p>通过git安装</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git clone git<span class="meta">@github</span>.com:appium/python-client.git</span><br><span class="line">cd python-client</span><br><span class="line">sudo python3.6 setup.py install</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h1 id="编写测试用例："><a href="#编写测试用例：" class="headerlink" title="编写测试用例："></a>编写测试用例：</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> appium <span class="keyword">import</span> webdriver</span><br><span class="line"></span><br><span class="line">desired_caps = &#123;&#125;</span><br><span class="line">desired_caps[<span class="string">'platformName'</span>] = <span class="string">'Android'</span></span><br><span class="line">desired_caps[<span class="string">'platformVersion'</span>] = <span class="string">'5.0'</span></span><br><span class="line">desired_caps[<span class="string">'deviceName'</span>] = <span class="string">'SA17607795'</span></span><br><span class="line">desired_caps[<span class="string">'appPackage'</span>] = <span class="string">'com.android.calculator2'</span></span><br><span class="line">desired_caps[<span class="string">'appActivity'</span>] = <span class="string">'.Calculator'</span></span><br><span class="line">driver = webdriver.Remote(<span class="string">'http://localhost:4723/wd/hub'</span>, desired_caps)</span><br><span class="line">driver.find_element_by_android_uiautomator(<span class="string">'new UiSelector().text("1")'</span>).click()</span><br><span class="line">driver.find_element_by_android_uiautomator(<span class="string">'new UiSelector().text("2")'</span>).click()</span><br><span class="line">driver.find_element_by_android_uiautomator(<span class="string">'new UiSelector().text("3")'</span>).click()</span><br><span class="line">driver.find_element_by_android_uiautomator(<span class="string">'new UiSelector().text("+")'</span>).click()</span><br><span class="line">driver.find_element_by_android_uiautomator(<span class="string">'new UiSelector().text("3")'</span>).click()</span><br><span class="line">driver.find_element_by_android_uiautomator(<span class="string">'new UiSelector().text("2")'</span>).click()</span><br><span class="line">driver.find_element_by_android_uiautomator(<span class="string">'new UiSelector().text("1")'</span>).click()</span><br><span class="line">driver.find_element_by_android_uiautomator(<span class="string">'new UiSelector().text("=")'</span>).click()</span><br><span class="line">driver.quit()</span><br></pre></td></tr></table></figure>
<h1 id="执行命令："><a href="#执行命令：" class="headerlink" title="执行命令："></a>执行命令：</h1><p><code>python3.6 android_calculator.py</code></p>
<h1 id="遇到的问题"><a href="#遇到的问题" class="headerlink" title="遇到的问题"></a>遇到的问题</h1><ol>
<li>问题：<code>driver.find_element_by_name(&quot;=&quot;).click()</code></li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">selenium.common.exceptions.InvalidSelectorException: Message: Locator Strategy <span class="string">'name'</span> is not supported <span class="keyword">for</span> <span class="keyword">this</span> session</span><br></pre></td></tr></table></figure>
<p>谷歌后得知：通过name获取控件的方式在Appium 1.5就被移除了。</p>
<ol start="2">
<li>问题：<code>driver.find_element_by_accessibility_id(&#39;com.android.calculator2:id/digit_1&#39;).click()</code></li>
</ol>
<p>报错：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">selenium.common.exceptions.NoSuchElementException: Message: An element could <span class="keyword">not</span> be located on the page using the given search parameters.</span><br></pre></td></tr></table></figure>
<p>经请教后得知在最新版本Appium中不再支持通过id的方式来定位元素。</p>
<p>改用：<code>driver.find_element_by_android_uiautomator(&#39;new UiSelector().text(&quot;1&quot;)&#39;).click()</code>，可运行</p>
<ol start="3">
<li>问题： 执行appium程序时遇到如下报错，ImportError: cannot import name ‘InvalidArgumentException’，</li>
</ol>
<p>报错原因 selenium.common.exceptions.py中未定义InvalidArgumentException类，导致出现该报错，我的解决办法是 </p>
<p>在selenium.common.exceptions.py中直接定义了InvalidArgumentException，代码如下（C:\Users\Python35\Lib\site-packages\selenium\common）找到exceptions.py，添加下面的代码，再次执行脚本，ok.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">InvalidArgumentException</span><span class="params">(WebDriverException)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="keyword">pass</span></span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/11/05/Appium入坑指南——Appium中文版介绍/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Forwards">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Forwards">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/11/05/Appium入坑指南——Appium中文版介绍/" itemprop="url">Appium入坑指南——Appium中文版介绍</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-11-05T22:31:04+08:00">
                2018-11-05
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Appium-介绍"><a href="#Appium-介绍" class="headerlink" title="Appium 介绍"></a>Appium 介绍</h1><p>Appium 是一个开源工具，用于自动化 iOS 手机 、 Android 手机和 Windows 桌面平台上的原生、移动 Web 和混合应用。“原生应用”指那些用 iOS 、 Android 或者 Windows SDK 编写的应用。“移动 web 应用”是用移动端浏览器访问的应用（Appium 支持 iOS 上的 Safari 、Chrome 和 Android 上的内置浏览器）。“混合应用”带有一个 “webview” 的包装器——用来和 Web 内容交互的原生控件。类似 <a href="http://phonegap.com/" target="_blank" rel="noopener">Phonegap</a> 的项目，让用 Web 技术开发然后打包进原生包装器创建一个混合应用变得容易了。</p>
<p>重要的是，Appium 是跨平台的：它允许你用同样的 API 对多平台写测试，做到在 iOS 、Android 和 Windows 测试套件之间复用代码。</p>
<p>了解 Appium “支持”这些平台意味着什么、有哪些自动化方式的详细信息，请参见<a href="http://appium.io/docs/cn/appium-setup/platform-support/index.html" target="_blank" rel="noopener"> Appium 支持的平台</a>。</p>
<h1 id="Appium-的理念"><a href="#Appium-的理念" class="headerlink" title="Appium 的理念"></a>Appium 的理念</h1><p>Appium 旨在满足移动端自动化需求的理念，概述为以下四个原则：</p>
<ol>
<li>你没有必要为了自动化而重新编译你的应用或者以任何方式修改它。</li>
<li>你不应该被限制在特定的语言或框架上来编写运行测试。</li>
<li>移动端自动化框架在自动化接口方面不应该重造轮子。</li>
<li>移动端自动化框架应该开源，不但在名义上而且在精神和实践上都要实至名归。</li>
</ol>
<h2 id="Appium-的设计"><a href="#Appium-的设计" class="headerlink" title="Appium 的设计"></a>Appium 的设计</h2><p>那么 Appium 项目的架构如何实现这一理念呢？为了实现第一点要求，我们其实使用了系统自带的自动化框架。这样，我们不需要把 Appium 特定的或者第三方的代码编译进你的应用。这意味着你测试使用的应用与最终发布的应用并无二致。我们使用以下系统自带的自动化框架：</p>
<ul>
<li>iOS 9.3 及以上：苹果的 <a href="https://developer.apple.com/reference/xctest" target="_blank" rel="noopener">XCUITest</a></li>
<li>iOS 9.3 及以下：苹果的 <a href="https://web.archive.org/web/20160904214108/https://developer.apple.com/library/ios/documentation/DeveloperTools/Reference/UIAutomationRef/" target="_blank" rel="noopener">UIAutomation</a></li>
<li>Android 4.2+: 谷歌的 <a href="https://developer.android.com/training/testing/ui-automator" target="_blank" rel="noopener">UiAutomator</a></li>
<li>Android 2.3+: 谷歌的 <a href="http://developer.android.com/reference/android/app/Instrumentation.html" target="_blank" rel="noopener">Instrumentation</a>（通过绑定另外的项目——<a href="http://selendroid.io/" target="_blank" rel="noopener"> Selendroid </a>提供 Instrumentation 的支持）</li>
<li>Windows: 微软的 <a href="http://github.com/microsoft/winappdriver" target="_blank" rel="noopener">WinAppDriver</a></li>
</ul>
<p>为了实现第二点要求，我们把这些（系统本身的）供应商提供的框架包装进一套 API —— <a href="http://docs.seleniumhq.org/projects/webdriver/" target="_blank" rel="noopener">WebDriver</a> API 中。WebDriver（也叫 “Selenium WebDriver”）规定了一个客户端-服务器协议（称为 <a href="https://w3c.github.io/webdriver/webdriver-spec.html" target="_blank" rel="noopener">JSON Wire Protocol</a>），按照这种客户端-服务器架构，可以使用任何语言编写的客户端向服务器发送适当的 HTTP 请求。已经有<a href="http://appium.io/downloads" target="_blank" rel="noopener">各个流行编程语言编写的客户端</a>了。这也意味着你可以自由使用任何你想要的测试运行器和测试框架；客户端程序库不过是 HTTP 客户端，可以以任何你喜欢的方式混入你的代码。换句话说，Appium 和 WebDriver 客户端不是严格意义上的“测试框架”，而是“自动化程序库”。你可以以任何你喜欢的方式管理你的测试环境！</p>
<p>我们以同样的方式实现第三点要求：WebDriver 已经成为 Web 浏览器自动化事实上的标准，并且是一个<a href="https://dvcs.w3.org/hg/webdriver/raw-file/tip/webdriver-spec.html" target="_blank" rel="noopener"> W3C 工作草案</a>。何必在移动端做完全不同的尝试？我们通过附加可用于移动端自动化的 API 方法<a href="https://github.com/SeleniumHQ/mobile-spec/blob/master/spec-draft.md" target="_blank" rel="noopener">扩展了协议</a>。</p>
<p>显然第 4 点是你在阅读的前提——<a href="https://github.com/appium/appium" target="_blank" rel="noopener"> Appium 是开源的</a></p>
<h1 id="Appium-概念"><a href="#Appium-概念" class="headerlink" title="Appium 概念"></a>Appium 概念</h1><h2 id="客户端-服务器架构"><a href="#客户端-服务器架构" class="headerlink" title="客户端/服务器架构"></a>客户端/服务器架构</h2><p>Appium 的核心是暴露 REST API 的网络服务器。它接受来自客户端的连接，监听命令并在移动设备上执行，答复表示执行结果的 HTTP 响应。客户端/服务器架构实际给予了许多可能性：我们可以使用任何有 http 客户端 API 的语言编写我们的测试代码，不过选一个<a href="http://appium.io/downloads" target="_blank" rel="noopener"> Appium 客户端程序库 </a>用更容易。我们可以把服务器放在另一台机器上，而不是执行测试的机器。我们可以编写测试代码，并依靠类似 <a href="https://saucelabs.com/mobile" target="_blank" rel="noopener">Sauce Labs</a> 的云服务接收和解释命令。</p>
<h2 id="会话-session"><a href="#会话-session" class="headerlink" title="会话(session)"></a>会话(session)</h2><p>自动化始终在一个会话的上下文中执行，这些客户端程序库以各自的方式发起与服务器的会话，但都以发给服务器一个 <code>POST /session</code> 请求结束，请求中包含一个被称作 ‘desired capabilities’ 的 JSON 对象。这时服务器就会开启这个自动化会话，并返回一个用于发送后续命令的会话 ID。</p>
<h2 id="Desired-Capabilities"><a href="#Desired-Capabilities" class="headerlink" title="Desired Capabilities"></a>Desired Capabilities</h2><p>Desired capabilities 是一些发送给 Appium 服务器的键值对集合 (比如 map 或 hash），告诉服务器我们想要启动什么类型的自动化会话。也有各种可以在自动化运行时修改服务器行为的 capabilities。例如，我们可以把 <code>platformName</code> capability 设置为 <code>iOS</code>，告诉 Appium 我们想要 iOS 会话，而不是 Android 或者 Windows 会话。我们也可以设置 <code>safariAllowPopups</code> capability 为 <code>true</code> ，确保我们在 Safari 自动化会话中可以使用 javascript 打开新窗口。有关 Appium capabilities 的完整列表，请参阅 <a href="http://appium.io/docs/cn/writing-running-appium/caps/index.html" target="_blank" rel="noopener">capabilities doc</a> 。</p>
<h2 id="Appium-服务器"><a href="#Appium-服务器" class="headerlink" title="Appium 服务器"></a>Appium 服务器</h2><p>Appium 是用 Node.js 写的服务器。它可以从<a href="https://github.com/appium/appium/blob/master/docs/en/contributing-to-appium/appium-from-source.md" target="_blank" rel="noopener">源码</a>构建安装或者从 NPM 直接安装：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ npm install -g appium</span><br><span class="line">$ appium</span><br></pre></td></tr></table></figure>
<p><strong>Appium 客户端</strong><br>有多个客户端程序库（Java、Ruby、Python、PHP,、JavaScript 和 C# 的）支持 Appium 对 WebDriver 协议的扩展，你需要用这些客户端程序库代替通常的 WebDriver 客户端。在<a href="http://appium.io/docs/cn/about-appium/appium-clients/" target="_blank" rel="noopener">这里</a>浏览所有程序库的列表。</p>
<p><strong>Appium.app, Appium.exe</strong><br>有 Appium 服务器的图形界面包装器可以下载。它们打包了 Appium 服务器运行需要的所有东西，所以你不需要为 Node 而烦恼。它们还提供一个 Inspector 使你可以查看你应用的层级结构，这在写测试时很方便。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/11/05/Appium入坑指南——Appium原理分析/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Forwards">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Forwards">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/11/05/Appium入坑指南——Appium原理分析/" itemprop="url">Appium入坑指南——Appium原理分析</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-11-05T22:29:10+08:00">
                2018-11-05
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="架构图"><a href="#架构图" class="headerlink" title="架构图"></a>架构图</h1><img src="http://pcmve13p6.bkt.clouddn.com/static/images/Appium架构图.jpeg">
<img src="http://pcmve13p6.bkt.clouddn.com/static/images/Appium架构图-2.jpg">
<h1 id="主要原理"><a href="#主要原理" class="headerlink" title="主要原理"></a>主要原理</h1><ol>
<li><p>Appium Client</p>
<p>主要是指实现了Appium功能的WebDriver协议的客户端Library，它负责与Appium服务器建立连接（<code>JSON Wire Protocol</code>），并将测试脚本的指令发送到Appium服务器。正如官网中文版介绍一样，它支持多种语言的客户端。</p>
</li>
<li><p>Bootstrap.jar</p>
<p>Bootstrap是Appium运行在目标测试机器上的一个UiAutomator测试脚本，该脚本的唯一一个测试方法所做的事情是在目标机器开启一个socket服务器来把一个session中Appium从PC端过来的命令发送给UiAutomator来执行处理。这个定义说明了Bootstrap在appium和uiautomator中究竟处于一个什么样的角色：<br>首先，它是一个uiautomator的测试脚本，它的入口类Bootstrap继承于UiAutomatorTestCase，所以UiAututomator可以正常运行它，它也可以正常的使用uiautomator的方法，这个就是Appium的命令可以转换成uiautomator的命令的关键<br>其次，它是一个socket服务器，它专门监听4724端口过来的appium的连接和命令数据，并把appium的命令转换成uiautomator的命令来让uiautomator进行处理<br>最后，它处理的是appium从pc端过来的命令，而非一个文件。这在初次接触appium的朋友是很容易困惑的，以为appium是整个脚本文件发送到目标机器再由bootstrap进行分析处理的，事实并非如此</p>
</li>
<li><p>Appium Server</p>
<p>Appium服务器是Appium框架的核心。它是一个基于Node.js实现的HTTP服务器。Appium服务器的主要功能是起了一个Server（4723端口），跟selenium WebDriver测试框架类似，Appium支持标准的WebDriver JSONWireProtocol。Appium Server接收web driver标准请求，解析请求内容，调用对应的框架响应操作。将命令发送给bootstrap.jar（iOS手机为bootstrap.js）执行，并将命令的执行结果通过HTTP应答反馈给Appium客户端。</p>
</li>
</ol>
<h1 id="结论"><a href="#结论" class="headerlink" title="结论"></a>结论</h1><p>Appium在Android上基于UIAutomator实现了测试的代理程序（Bootstrap.jar），在iOS上基于UIAutomation实现了测试的代理程序（Bootstrap.js）。当测试脚本运行时，每行WebDriver的脚本都将转换成Appium的指令发送给Appium服务器，而Appium服务器将测试指令交给代理程序，将由代理程序负责执行测试。比如脚本上的一个点击操作，在Appium服务器上都是touch指令，当指令发送到Android系统上时，Android系统上的Bootstrap.jar将调用UIAutomator的方法实现点击操作；而当指令发送到iOS系统上时，iOS的Bootstrap.js将调用UIAutomation的方法实现点击操作。由于Appium有了这样的能力，同样的测试脚本可以实现跨平台运行。</p>
<h1 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h1><p><a href="https://www.jianshu.com/p/06aa73eb9b90" target="_blank" rel="noopener">https://www.jianshu.com/p/06aa73eb9b90</a></p>
<p><a href="https://testerhome.com/topics/1972" target="_blank" rel="noopener">https://testerhome.com/topics/1972</a></p>
<p><a href="https://discuss.appium.io/t/what-is-working-on-android-side/10222/2" target="_blank" rel="noopener">https://discuss.appium.io/t/what-is-working-on-android-side/10222/2</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/11/05/Appium入坑指南——环境搭建/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Forwards">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Forwards">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/11/05/Appium入坑指南——环境搭建/" itemprop="url">Appium入坑指南——环境搭建</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-11-05T22:21:11+08:00">
                2018-11-05
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>前言：本文操作系统基于ubuntu 16.04（Windows搭建步骤大同小异），Appium有两种方式搭建：1、通过npm安装；2、通过Appium Desktop安装。</p>
<p><em>注：本系列文章仅为笔者学习笔记，大量文字均是摘录自热心网友的文章，如未注明转载皆为无心之失。</em></p>
<h1 id="通过npm安装"><a href="#通过npm安装" class="headerlink" title="通过npm安装"></a>通过npm安装</h1><h2 id="安装node-js和npm"><a href="#安装node-js和npm" class="headerlink" title="安装node.js和npm"></a>安装node.js和npm</h2><ol>
<li><p>安装node.js和npmd</p>
<p>从<a href="https://nodejs.org/en/" target="_blank" rel="noopener">官网</a>下载node.js最新稳定版本</p>
</li>
<li><p>本地解压： <code>tar -Jxvf node-v8.12.0-linux-x64.tar.xz</code></p>
</li>
<li><p>在/etc/profile文件中添加环境变量：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">export PATH=/home/hezj/Software/node/node-v8.12.0-linux-x64/bin:$PATH</span><br><span class="line"></span><br><span class="line">export PATH=/home/hezj/Software/node/node-v8.12.0-linux-x64/lib/node_modules:$PATH</span><br></pre></td></tr></table></figure>
<p>重启电脑使之生效。</p>
</li>
<li><p>验证node和npm是否安装成功</p>
<p><code>node -v</code>,<code>npm -v</code></p>
</li>
</ol>
<h2 id="通过npm安装Appium"><a href="#通过npm安装Appium" class="headerlink" title="通过npm安装Appium"></a>通过npm安装Appium</h2><ol>
<li><p>npm安装需要翻墙，我们使用淘宝镜像</p>
<p>配置npm的下载镜像：</p>
<p><code>npm config set registry https://registry.npm.taobao.org</code></p>
</li>
<li><p>使用淘宝定制的cnpm工具代替默认的npm</p>
<p><code>npm install -g cnpm --registry=https://registry.npm.taobao.org</code></p>
</li>
<li><p>使用：<code>cnpm install express</code></p>
</li>
<li><p>安装Appium：<code>cnpm install -g appium</code></p>
</li>
<li><p>检查Appium是否安装成功：<code>appium -v</code></p>
</li>
</ol>
<h2 id="安装appium-doctor"><a href="#安装appium-doctor" class="headerlink" title="安装appium-doctor"></a>安装appium-doctor</h2><p>安装appium-doctor，检查appium的所有依赖环境是否已经安装好</p>
<ol>
<li><p><code>npm install -g appium-doctor</code></p>
</li>
<li><p>运行appium-doctor：</p>
<p><code>appium-doctor</code></p>
<p>附上一张安装成功的截图：</p>
<img src="http://pcmve13p6.bkt.clouddn.com/static/images/appium-doctor.png">
</li>
</ol>
<h2 id="遇到的问题："><a href="#遇到的问题：" class="headerlink" title="遇到的问题："></a>遇到的问题：</h2><ol>
<li><p>未设置ANDROID_HOME环境变量：</p>
<p><code>export ANDROID_HOME=/home/hezj/Software/AndroidStudio/SDK/</code></p>
<p><code>export PATH=${ANDROID_HOME}/tools:$PATH</code></p>
<p><code>export PATH=${ANDROID_HOME}/platform-tools:$PATH</code></p>
</li>
</ol>
<h1 id="通过Appium-Desktop安装"><a href="#通过Appium-Desktop安装" class="headerlink" title="通过Appium Desktop安装"></a>通过Appium Desktop安装</h1><ol>
<li><p>在官网上下载<a href="https://github.com/appium/appium-desktop/releases/tag/1.7.0" target="_blank" rel="noopener">appium-desktop</a>，注意：ubuntu环境下要下载.AppImage结尾的文件</p>
</li>
<li><p>执行<code>chmod a+x appium-desktop-1.7.0-x86_64.AppImage</code>，然后<code>sudo ./appium-desktop-1.7.0-x86_64.AppImage</code></p>
<p>遇到的问题：</p>
<p>在直接启动appium-desktop-1.7.0-x86_64.AppImage之后，点击Start Server V1.9.0，会报错，错误截图如下：</p>
<img src="http://pcmve13p6.bkt.clouddn.com/static/images/权限拒绝.png">
</li>
</ol>
<p>暂无解决办法，只好每次都执行<code>sudo ./appium-desktop-1.7.0-x86_64.AppImage</code>.</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/09/17/软件设计原则和设计模式小记(二)/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Forwards">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Forwards">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/09/17/软件设计原则和设计模式小记(二)/" itemprop="url">软件设计原则和设计模式小记（二）</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-09-17T22:38:36+08:00">
                2018-09-17
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>在上篇<a href="http://ucoon.tech/2018/08/07/%E8%BD%AF%E4%BB%B6%E8%AE%BE%E8%AE%A1%E5%8E%9F%E5%88%99%E5%92%8C%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E5%B0%8F%E8%AE%B0/" target="_blank" rel="noopener">软件设计原则和设计模式小记（一）</a>中，主要介绍了面向对象的S.O.L.I.D原则和高内聚、低耦合的概念。本文将继续介绍常用的几种设计模式：单例模式、简单工厂模式、策略模式、适配器模式、模板方法模式、装饰者模式以及享元模式。</p>
<h1 id="单例模式"><a href="#单例模式" class="headerlink" title="单例模式"></a>单例模式</h1>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/08/07/软件设计原则和设计模式小记/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Forwards">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Forwards">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/08/07/软件设计原则和设计模式小记/" itemprop="url">软件设计原则和设计模式小记（一）</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-08-07T21:36:44+08:00">
                2018-08-07
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>从部门老大对于软件设计原则和设计模式的分享，再到近阶段的工作都涉及了软件设计相关的知识，都让我对软件设计这一块难啃的骨头有了小小的认识。本文中的软件设计原则也只简要论述了<strong>面向对象的S.O.L.I.D原则</strong> ，设计模式也只介绍了常用的几种。</p>
<h1 id="面向对象的S-O-L-I-D原则"><a href="#面向对象的S-O-L-I-D原则" class="headerlink" title="面向对象的S.O.L.I.D原则"></a>面向对象的S.O.L.I.D原则</h1><p><strong>SOLID</strong>是五个面向对象编程的重要原则的缩写，它是由Robert C. Martin（Bob大叔）在21世纪初定义的。它是每个开发者必备的基本知识。运用这些原则能让我们写出更优质的代码，能使我们的代码更健壮，更易于维护，有更好的可持续性、扩展性和鲁棒的代码。</p>
<h2 id="高内聚"><a href="#高内聚" class="headerlink" title="高内聚"></a>高内聚</h2><p>内聚：一个模块内各个元素彼此结合的紧密程度；高内聚就是每个模块尽可能独立完成自己的功能，不依赖模块外部的代码。</p>
<h3 id="Single-Responsibility-Principle-SRP-—-单一职责原则"><a href="#Single-Responsibility-Principle-SRP-—-单一职责原则" class="headerlink" title="Single Responsibility Principle(SRP) — 单一职责原则"></a>Single Responsibility Principle(SRP) — 单一职责原则</h3><h4 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h4><blockquote>
<p>一个类或者模块应该有且只有一个改变的原因</p>
</blockquote>
<p>职责单一原则的核心思想是：一个类或模块只负责一个功能，并且只有一个引起它变化的原因。单一职责原则可以看作是低耦合，高内聚在面向对象的引申，将职责定义为引起变化的原因，以提高内聚性来减少引起变化的原因。 职责越多，可能引起它变化的原因就越多，也将导致职责依赖严重，从而使耦合度增大。</p>
<h4 id="代码示例"><a href="#代码示例" class="headerlink" title="代码示例"></a>代码示例</h4><p>首先我们先看一个用户信息类（UserInfo）：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IUserInfo</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span></span>;</span><br><span class="line">    <span class="function">String <span class="title">getName</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span></span>;</span><br><span class="line">    <span class="function">String <span class="title">getPassword</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">setPassword</span><span class="params">(String password)</span></span>;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">addUser</span><span class="params">(UserInfo user)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">deleteUser</span><span class="params">(<span class="keyword">int</span> id)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>上面的代码将业务对象和业务逻辑的内容放到了一个类中，业务对象和业务逻辑都会引起IUserInfo类的变化，上面的代码就违反了单一职责原则。按照SRP原则，我们应该<strong>为不同的职责创建不同的类</strong>，修改如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IUserBro</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span></span>;</span><br><span class="line">    <span class="function">String <span class="title">getName</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span></span>;</span><br><span class="line">    <span class="function">String <span class="title">getPassword</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">setPassword</span><span class="params">(String password)</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IUserBiz</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">addUser</span><span class="params">(UserInfo user)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">deleteUser</span><span class="params">(<span class="keyword">int</span> id)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这样，我们就有了两个类，但是<strong>每个类都有单一的职责</strong>，我们使它变成了低耦合高内聚。</p>
<h4 id="好处"><a href="#好处" class="headerlink" title="好处"></a>好处</h4><ul>
<li>降低耦合性</li>
<li>代码易于理解和维护</li>
</ul>
<h3 id="Interface-Segregation-Principle-ISP-—-接口隔离原则"><a href="#Interface-Segregation-Principle-ISP-—-接口隔离原则" class="headerlink" title="Interface Segregation Principle(ISP) — 接口隔离原则"></a>Interface Segregation Principle(ISP) — 接口隔离原则</h3><h4 id="定义-1"><a href="#定义-1" class="headerlink" title="定义"></a>定义</h4><blockquote>
<p>使用多个专用的接口比使用一个通用接口好</p>
</blockquote>
<p>ISP原则意思是把功能实现在接口中，而不是类中；并且一个类绝不要实现不会用到的接口。不遵循这个原则意味着我们在实现里会依赖很多我们并不需要的方法，但又不得不去定义。所以，实现多个特定的接口比实现一个通用接口要好。一个接口被需要用到的类所定义，所以这个接口不应该有这个类不需要实现的其他方法。</p>
<h4 id="代码示例-1"><a href="#代码示例-1" class="headerlink" title="代码示例"></a>代码示例</h4><p>我们有一个ICar的接口：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ICar</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">startEngine</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">accelerate</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>同时也有一个实现ICar接口的Mustang类：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Mustang</span> <span class="keyword">implements</span> <span class="title">ICar</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">startEngine</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//start engine...</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">accelerate</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//accelerate...</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>现在要添加一个新的车型：一辆DeloRean，可以穿梭时空。</p>
<p>我们修改ICar接口类以满足此需求：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ICar</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">startEngine</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">accelerate</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">backToThePast</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">backToTheFuture</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>新增DeloRean类实现ICar接口：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DeloRean</span> <span class="keyword">implements</span> <span class="title">ICar</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">startEngine</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//start engine...</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">accelerate</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//accelerate...</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">backToThePast</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//back to the past...</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">backToTheFuture</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//back to the future...</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>同时修改Mustang类：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Mustang</span> <span class="keyword">implements</span> <span class="title">ICar</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">startEngine</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//start engine...</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">accelerate</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//accelerate...</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">backToThePast</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//Mustang没有穿梭时空的能力</span></span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> UnsupportedOperationException();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">backToTheFuture</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//Mustang没有穿梭时空的能力</span></span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> UnsupportedOperationException();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这种情况下，Mustang违反了接口隔离原则，它实现了它不需要的方法。</p>
<p><strong>使用接口隔离的解决方法：</strong></p>
<p>重构ICar接口：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ICar</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">startEngine</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">accelerate</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>新增ITimeMachine接口：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ITimeMachine</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">backToThePast</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">backToTheFuture</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>重构Mustang（只实现ICar接口）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Mustang</span> <span class="keyword">implements</span> <span class="title">ICar</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">startEngine</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//start engine...</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">accelerate</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//accelerate...</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>重构DeloRean（同时实现ICar和ITimeMachine）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DeloRean</span> <span class="keyword">implements</span> <span class="title">ICar</span>, <span class="title">ITimeMachine</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">startEngine</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//start engine...</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">accelerate</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//accelerate...</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">backToThePast</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//back to the past...</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">backToTheFuture</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//back to the future...</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="好处-1"><a href="#好处-1" class="headerlink" title="好处"></a>好处</h4><ul>
<li>系统解耦</li>
<li>代码易于重构</li>
</ul>
<h2 id="低耦合"><a href="#低耦合" class="headerlink" title="低耦合"></a>低耦合</h2><p>耦合：模块与模块之间接口的复杂程度，模块之间联系越复杂耦合度越高，牵一发动全身；低耦合就是要尽可能减少模块之间的交互复杂程度。</p>
<h3 id="Open-Closed-Principle-OCP-—-开闭原则"><a href="#Open-Closed-Principle-OCP-—-开闭原则" class="headerlink" title="Open/Closed Principle(OCP) — 开闭原则"></a>Open/Closed Principle(OCP) — 开闭原则</h3><h4 id="定义-2"><a href="#定义-2" class="headerlink" title="定义"></a>定义</h4><blockquote>
<p>软件中的对象（类、模块、函数等等）应该对于扩展是开放的，但是对于修改是封闭的</p>
</blockquote>
<p>根据这一原则，一个实体是允许在不改变它的源代码的前提下变更它的行为。</p>
<ul>
<li><strong>open for extension</strong>：对扩展开放，意味着有新的需求或变化时，可以对现有代码进行扩展，以适应新的情况。</li>
<li><strong>close for modification</strong>：对修改封闭，意味着扩展新的功能行为而不需要也不应该修改现有的代码。</li>
</ul>
<p>对于面向对象来说，需要你依赖抽象，而不是实现。</p>
<h4 id="代码示例-2"><a href="#代码示例-2" class="headerlink" title="代码示例"></a>代码示例</h4><p>首先我们有两个不同形状的类：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Rectangle</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> width;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> height;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//getter and setter methods...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Square</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> side;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//getter and setter methods...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>其次我们还有一个类可以画出不同的形状：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ShapePrinter</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">drawShape</span><span class="params">(Object shape)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(shape <span class="keyword">instanceof</span> Rectangle)&#123;</span><br><span class="line">            <span class="comment">//Draw Rectangle...</span></span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span>(shape <span class="keyword">instanceof</span> Square)&#123;</span><br><span class="line">            <span class="comment">//Draw Square...</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>从上面可以看到，当我们每次想画一个新的形状就要<strong>修改ShapePrinter类的drawShape方法来接受这个新的形状</strong>。这样当形状种类多了之后，ShapePrinter类就会存在大量的<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">按照OCP原则，修改如下：</span><br><span class="line"></span><br><span class="line">我们添加一个Shape接口类：</span><br><span class="line"></span><br><span class="line">```java</span><br><span class="line">public interface Shape&#123;</span><br><span class="line">    void draw();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>重构Rectangle类和Square类以实现Shape：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Rectangle</span> <span class="keyword">implements</span> <span class="title">Shape</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> width;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> height;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//getter and setter methods...</span></span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">draw</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//Draw Rectangle...</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Square</span> <span class="keyword">implements</span> <span class="title">Shape</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> side;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//getter and setter methods...</span></span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">draw</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//Draw Square...</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ShapePrinter类的重构：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">drawShape</span><span class="params">(Shape shape)</span></span>&#123;</span><br><span class="line">        shape.draw();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<h4 id="好处-2"><a href="#好处-2" class="headerlink" title="好处"></a>好处</h4><ul>
<li>代码的可维护性和复用性</li>
<li>代码会更健壮 </li>
</ul>
<h3 id="Liskov-Substitution-Principle-LSP-—-里氏替换原则"><a href="#Liskov-Substitution-Principle-LSP-—-里氏替换原则" class="headerlink" title="Liskov Substitution Principle(LSP) — 里氏替换原则"></a>Liskov Substitution Principle(LSP) — 里氏替换原则</h3><h4 id="定义-3"><a href="#定义-3" class="headerlink" title="定义"></a>定义</h4><blockquote>
<p>派生类（子类）对象可以在程式中代替其基类（超类）对象。“Subtypes must be substituable for their base types”</p>
</blockquote>
<p>根据定义所说，程序里的对象都应该可以被它的子类实例替换而不用更改程序，另外不应该在代码中出现if/else之类对子类类型进行判断的条件。里氏替换原则是使代码符合开闭原则的一个重要保证。正是由于子类的可替换性才使得父类型的模块在无需修改的情况下就可以扩展。</p>
<h4 id="代码示例-3"><a href="#代码示例-3" class="headerlink" title="代码示例"></a>代码示例</h4><p>我们有一个Rectangle类：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Rectangle</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> width;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> height;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setHeight</span><span class="params">(<span class="keyword">int</span> height)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.height = height;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setWidth</span><span class="params">(<span class="keyword">int</span> width)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.width = width;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getArea</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> width*height;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>还有一个Square类（从数学上讲正方形也是长方形的一种）：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Square</span> <span class="keyword">extends</span> <span class="title">Rectangle</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setHeight</span><span class="params">(<span class="keyword">int</span> height)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.setWidth(height);</span><br><span class="line">        <span class="keyword">super</span>.setHeight(height);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setWidth</span><span class="params">(<span class="keyword">int</span> width)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.setWidth(width);</span><br><span class="line">        <span class="keyword">super</span>.setHeight(width);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>然后我们写个测试函数：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LiskovSubstitutionTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String args[])</span></span>&#123;</span><br><span class="line">        Rectangle rectangle = <span class="keyword">new</span> Rectangle();</span><br><span class="line">        rectangle.setWidth(<span class="number">2</span>);</span><br><span class="line">        rectangle.setHeight(<span class="number">5</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (rectangle.getArea() == <span class="number">10</span>)&#123;</span><br><span class="line">         System.out.println(rectangle.getArea());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>同样的函数却不适用Square：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LiskovSubstitutionTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String args[])</span></span>&#123;</span><br><span class="line">        Rectangle rectangle = <span class="keyword">new</span> Square();</span><br><span class="line">        rectangle.setWidth(<span class="number">2</span>);</span><br><span class="line">        rectangle.setHeight(<span class="number">5</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (rectangle.getArea() == <span class="number">10</span>)&#123;</span><br><span class="line">         System.out.println(rectangle.getArea());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>从代码上看出Square并不能正确替代Rectangle类，因为它不遵循Rectangle的行为规则，违反了LSP原则。</p>
<p>解决方法：</p>
<p>用IShape接口来获取面积：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IShape</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">area</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>重构Rectangle和Square以实现IShape：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Rectangle</span> <span class="keyword">implements</span> <span class="title">IShape</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> width;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> height;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setHeight</span><span class="params">(<span class="keyword">int</span> height)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.height = height;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setWidth</span><span class="params">(<span class="keyword">int</span> width)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.width = width;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">area</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> width*height;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>修改函数：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LiskovSubstitutionTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String args[])</span></span>&#123;</span><br><span class="line">        IShape shape = <span class="keyword">new</span> Square();</span><br><span class="line">        shape.setWidth(<span class="number">2</span>);</span><br><span class="line">        shape.setHeight(<span class="number">5</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (shape.getArea() == <span class="number">10</span>)&#123;</span><br><span class="line">         System.out.println(shape.getArea());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="好处-3"><a href="#好处-3" class="headerlink" title="好处"></a>好处</h4><ul>
<li>更高的代码复用性</li>
<li>类的层次结构易于理解</li>
</ul>
<h3 id="Dependency-Inversion-Principle-DIP-—-依赖倒置原则"><a href="#Dependency-Inversion-Principle-DIP-—-依赖倒置原则" class="headerlink" title="Dependency Inversion Principle(DIP) — 依赖倒置原则"></a>Dependency Inversion Principle(DIP) — 依赖倒置原则</h3><h4 id="定义-4"><a href="#定义-4" class="headerlink" title="定义"></a>定义</h4><blockquote>
<p>高层次的模块不应该依赖于低层次的模块，两者都应该依赖于抽象接口</p>
<p>抽象接口不应该依赖于具体实现，而具体实现则应该依赖于抽象接口</p>
</blockquote>
<p>在面向对象编程领域中，依赖反转原则是指一个特定的类不应该直接依赖于另一个类，但是可以依赖于这个类的抽象（接口）。</p>
<p>附上来自维基百科上的图：</p>
<img src="http://pcmve13p6.bkt.clouddn.com/static/images/Dependency_inversion.jpg">
<p>图1中，高层对象A依赖于底层对象B的实现；图2中，把高层对象A对底层对象的需求抽象为一个接口A，底层对象B实现了接口A，这就是依赖反转。 </p>
<h4 id="代码示例-4"><a href="#代码示例-4" class="headerlink" title="代码示例"></a>代码示例</h4><p>我们有个DeliveryDriver类代表着一个司机为快递公司工作：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DeliveryDriver</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">deliveryProduct</span><span class="params">(Product product)</span></span>&#123;</span><br><span class="line">        <span class="comment">//运送产品</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>其次有个DeliveryCompany类处理货物装运：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DeliveryCompany</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sendProduct</span><span class="params">(Product product)</span></span>&#123;</span><br><span class="line">        DeliveryDriver deliveryDriver = <span class="keyword">new</span> DeliveryDriver();</span><br><span class="line">        deliveryDriver.deliveryProduct(product);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在上述代码中，DeliveryCompany创建并使用DeliveryDriver实例，所以DeliveryCompany是一个依赖于低层次类的高层次的类，这就违反了依赖反转原则（在上述代码中DeliveryCompany需要运送货物，必须需要一个DeliveryDriver参与，但如果以后对DeliveryDriver有更多的要求，那我们既要修改DeliveryDriver也要修改上述代码，这样造成的依赖，耦合度高。）</p>
<p>解决方法：</p>
<p>创建DeliveryService接口：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">DeliveryService</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">deliveryProduct</span><span class="params">(Product product)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>重构DeliveryDriver类以实现DeliveryService接口：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DeliveryDriver</span> <span class="keyword">implements</span> <span class="title">DeliveryService</span></span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">deliveryProduct</span><span class="params">(Product product)</span></span>&#123;</span><br><span class="line">        <span class="comment">//运送产品</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>重构DeliveryCompany类，使它依赖于一个抽象而不是一个具体的类：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DeliveryCompany</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> DeliveryService deliveryService;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">DeliveryCompany</span><span class="params">(DeliveryService deliveryService)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.deliveryService = deliveryService;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sendProduct</span><span class="params">(Product product)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.deliveryService.deliveryProduct(product);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="好处-4"><a href="#好处-4" class="headerlink" title="好处"></a>好处</h4><ul>
<li>减少耦合</li>
<li>代码更高的复用性</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/07/23/看懂UML时序图和类图/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Forwards">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Forwards">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/07/23/看懂UML时序图和类图/" itemprop="url">看懂UML时序图和类图</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-07-23T20:58:05+08:00">
                2018-07-23
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>最近在工作中第一次接触UML相关内容，本篇为学习笔记，写得不好，还请大神们多多指教。以下是本篇文章的大体结构。</p>
<img src="http://pcmve13p6.bkt.clouddn.com/static/images/看懂UML时序图和类图.png">
<h2 id="UML"><a href="#UML" class="headerlink" title="UML"></a>UML</h2><h3 id="1-定义"><a href="#1-定义" class="headerlink" title="1. 定义"></a>1. 定义</h3><p>以下定义引自维基百科：</p>
<blockquote>
<p>统一建模语言（Unified Modeling Language，缩写UML）是非专利的第三代建模和规约语言。UML是一种开放的方法，用于说明、可视化、构建和编写一个正在开发的、面向对象的、软件密集系统的制品的开放方法。</p>
</blockquote>
<h3 id="2-模型"><a href="#2-模型" class="headerlink" title="2. 模型"></a>2. 模型</h3><p>UML中的三个主要模型：</p>
<ol>
<li>功能模型：从用户的角度展示系统的功能，包括用例图</li>
<li>对象模型：采用对象、属性、操作、关联等概念展示系统的结构和基础，包括类别图、对象图</li>
<li>动态模型：展示系统的内部行为，包括序列图（时序图）、活动图和状态图。</li>
</ol>
<h3 id="3-图形"><a href="#3-图形" class="headerlink" title="3. 图形"></a>3. 图形</h3><p>在UML 2.2中一共定义了14种图示。这里只介绍序列图和类图。</p>
<h2 id="序列图"><a href="#序列图" class="headerlink" title="序列图"></a>序列图</h2><h3 id="1-定义-1"><a href="#1-定义-1" class="headerlink" title="1. 定义"></a>1. 定义</h3><p>序列图（Sequence Diagram），也叫做循序图，是一种UML行为图。大多数人翻译为时序图（维基百科上称这种叫法并不准确），UML规范中对Sequence Diagram是这么解释的：</p>
<blockquote>
<p>A sequence diagram describes an Interaction by focusing on the sequence of Messages that are exchanged, along with their corresponding Occurrence Specifications on the Lifelines</p>
</blockquote>
<p>事实上，序列图与我们中学时代学的流程图大同小异，它描述的是消息在生命线上按照约定顺序执行一种交互行为。它是属于一种动态模型。</p>
<h3 id="2-元素"><a href="#2-元素" class="headerlink" title="2. 元素"></a>2. 元素</h3><ol>
<li>对象（Object）</li>
<li>生命线（Lifeline）</li>
<li>消息（Message）</li>
<li>激活（Activation）</li>
</ol>
<h3 id="3-示例图"><a href="#3-示例图" class="headerlink" title="3. 示例图"></a>3. 示例图</h3><img src="http://pcmve13p6.bkt.clouddn.com/static/images/时序图示例.jpg">
<h2 id="类图"><a href="#类图" class="headerlink" title="类图"></a>类图</h2><h3 id="1-定义-2"><a href="#1-定义-2" class="headerlink" title="1.定义"></a>1.定义</h3><p>类图是统一建模语言中一种对象模型，这种图描述的是系统的类集合，类的属性和类之间的关系。</p>
<h3 id="2-元素-1"><a href="#2-元素-1" class="headerlink" title="2. 元素"></a>2. 元素</h3><img src="http://pcmve13p6.bkt.clouddn.com/static/images/类图示例.jpg">
<p>上图是类图的示例，一个类有三个区域，最上面的是类名称，中间部分是类的属性，底部是类的方法。</p>
<p>UML提供机制，以代表类的成员，如属性和方法。指定一个类成员（即任何属性和方法）的可见性有下列符号：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">+ <span class="keyword">public</span> 公有</span><br><span class="line">- <span class="keyword">private</span> 私有</span><br><span class="line"># protected 保护</span><br><span class="line">~ 包（即对包内其他成员可见）</span><br><span class="line">/ 推导（即由其他属性推导得出，不需要直接给定其值）</span><br></pre></td></tr></table></figure>
<h3 id="3-类图中的关系"><a href="#3-类图中的关系" class="headerlink" title="3. 类图中的关系"></a>3. 类图中的关系</h3><ol>
<li>泛化（Generalization）</li>
</ol>
<p>即继承(extend)的反方向。在UML类图中用带空心三角形的直线表示。如下图所示：</p>
<img src="http://pcmve13p6.bkt.clouddn.com/static/images/Generalization.jpg">
<ol start="2">
<li>实现（Realization）</li>
</ol>
<p>即对应implements关键字。用带空心三角形的虚线表示</p>
<img src="http://pcmve13p6.bkt.clouddn.com/static/images/Realization.jpg">
<ol start="3">
<li>依赖（Dependency）</li>
</ol>
<p>依赖关系可以理解为一个类A使用到了另一个类B，被依赖的对象只是作为一种工具在使用，<strong>而并不持有对它的引用。</strong> </p>
<blockquote>
<p>这种使用关系是具有偶然性、临时性的、非常弱的 </p>
</blockquote>
<p>但是B类的变化会影响到类A，表现在代码层面：类B作为参数被类A在某个方法中使用。用带燕尾箭头的虚线表示。</p>
<img src="http://pcmve13p6.bkt.clouddn.com/static/images/Dependency.jpg">
<ol start="4">
<li>聚合（Aggregate）</li>
</ol>
<p>聚合是表示整体与部分的一类特殊的关联关系，是弱的包含关系，成分类可以不依靠聚合类而单独存在，可以具有各自的生命周期，部分可以属于多个整体，也可以为多个整体对象共享。用以带空心的菱形剪尾的实线表示。</p>
<img src="http://pcmve13p6.bkt.clouddn.com/static/images/Aggregation.jpg">
<ol start="5">
<li>组合（Composition）</li>
</ol>
<p>组合是一类强的整体与部分的包含关系。成分类必须依靠合成类而存在，整体与部分是不可分的（这是与聚合关系最大的区别），整体的生命周期结束也就意味着部分的生命周期结束。图形中用带实心的菱形剪尾的实线表示。</p>
<img src="http://pcmve13p6.bkt.clouddn.com/static/images/Composition.jpg">
<ol start="6">
<li>关联（Association）</li>
</ol>
<p>关联是两个类之间，或类与接口之间一种强依赖关系，是一种长期的稳定关系。关联关系又分为单向关联、双向关联和自关联。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/05/27/魅族Android7-0-Settings源码分析/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Forwards">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Forwards">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/05/27/魅族Android7-0-Settings源码分析/" itemprop="url">魅族Android7-0-Settings源码分析</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-05-27T23:43:16+08:00">
                2018-05-27
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="魅族Android7-0-Settings源码分析"><a href="#魅族Android7-0-Settings源码分析" class="headerlink" title="魅族Android7-0-Settings源码分析"></a>魅族Android7-0-Settings源码分析</h1><p><strong>前言</strong>：</p>
<p>只能说对魅族手机系统很是无奈啊！！！为了分析魅族手机无法通过常见的方法跳到系统设置的无障碍服务，只好通过<strong>豌豆荚将settings.apk导出</strong>然后进行反编译，跟踪源码…….</p>
<h2 id="准备工作（反编译apk以及AndroidManifest-xml文件）"><a href="#准备工作（反编译apk以及AndroidManifest-xml文件）" class="headerlink" title="准备工作（反编译apk以及AndroidManifest.xml文件）"></a>准备工作（反编译apk以及AndroidManifest.xml文件）</h2><ol>
<li>从反编译一开始就碰上了坑，利用dex2jar-2.0无法导出classes-dex2jar.jar文件，原因暂未找到，解决方案是将classes.dex用nodepad++打开，将037，改成036，保存，再用dex2jar。</li>
</ol>
<blockquote>
<p>参考链接：<a href="https://www.jianshu.com/p/55bf5f688e9a" target="_blank" rel="noopener">https://www.jianshu.com/p/55bf5f688e9a</a></p>
</blockquote>
<ol start="2">
<li>反编译AndroidManifest.xml文件可请教谷歌</li>
</ol>
<h2 id="Settings应用的启动类"><a href="#Settings应用的启动类" class="headerlink" title="Settings应用的启动类"></a>Settings应用的启动类</h2><p>首先跟踪Settings的启动类，查看package/app/Settings/AndroidManifest.xml文件</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;activity-alias android:label=<span class="string">"@string/settings_label_launcher"</span> android:launchMode=<span class="string">"singleTask"</span> android:name=<span class="string">"com.android.settings.Settings"</span> android:targetActivity=<span class="string">"com.android.settings.Settings"</span> android:taskAffinity=<span class="string">"com.android.settings"</span>&gt;</span><br><span class="line">     &lt;intent-filter&gt;</span><br><span class="line">         &lt;action android:name=<span class="string">"android.intent.action.MAIN"</span>/&gt;</span><br><span class="line">         &lt;category android:name=<span class="string">"android.intent.category.DEFAULT"</span>/&gt;</span><br><span class="line">         &lt;category android:name=<span class="string">"android.intent.category.LAUNCHER"</span>/&gt;</span><br><span class="line">     &lt;/intent-filter&gt;</span><br><span class="line"> &lt;/activity-alias&gt;</span><br></pre></td></tr></table></figure>
<p><em>第一次遇到<activity-alias>标签，一脸懵逼o((⊙﹏⊙))o，查了才知道是作为一个已存在Activity的别名，可用来设置某个Activity的快捷入口。举例：某个Activity需要进入应用的主界面才能够点击进入，如果使用了该标签，甚至可以在桌面生成一个该Activity的图标，然后点击桌面图标直接进入该Activity。</activity-alias></em><br>从AndroidManifest.xml可以看到，Settings的启动类为Settings.java，源码如下：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Settings</span> <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">AccessibilityDaltonizerSettingsActivity</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">AccessibilitySettingsActivity</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">AccountSettingsActivity</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">AccountSyncSettingsActivity</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">AdvancedAppsActivity</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">AdvancedWifiSettingsActivity</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">AllApplicationsActivity</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">AndroidBeamSettingsActivity</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">ApnEditorActivity</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">ApnSettingsActivity</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">AppDrawOverlaySettingsActivity</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">AppMemoryUsageActivity</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">AppNotificationSettingsActivity</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">AppWriteSettingsActivity</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">AvailableVirtualKeyboardActivity</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">BackgroundCheckSummaryActivity</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">BatterySaverSettingsActivity</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">BluetoothSettingsActivity</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">CaptioningSettingsActivity</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">ChooseAccountActivity</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">ConfigureNotificationSettingsActivity</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">CryptKeeperSettingsActivity</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">DataUsageSummaryActivity</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">DateTimeSettingsActivity</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">DevelopmentSettingsActivity</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">DeviceAdminSettingsActivity</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">DeviceInfoSettingsActivity</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">DeviceSettings</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">DisplaySettingsActivity</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">DomainsURLsAppListActivity</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">DreamSettingsActivity</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">FingerprintEnrollSuggestionActivity</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">FingerprintEnrollIntroduction</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">FingerprintSuggestionActivity</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">FingerprintSettings</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">HighPowerApplicationsActivity</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">HomeSettingsActivity</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">IccLockSettingsActivity</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">ImeiInformationActivity</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">InputMethodAndLanguageSettingsActivity</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">KeyboardLayoutPickerActivity</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">LocalePickerActivity</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">LocationSettingsActivity</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">ManageApplicationsActivity</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">ManageAssistActivity</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">MemorySettingsActivity</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">NotificationAccessSettingsActivity</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">NotificationAppListActivity</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">NotificationStationActivity</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">NotificationStatusbarSettingsActivity</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">OtherSoundSettingsActivity</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">OverlaySettingsActivity</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">PaymentSettingsActivity</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">PersonalSettings</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">PhysicalKeyboardActivity</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">PowerUsageSummaryActivity</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">PrintJobSettingsActivity</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">PrintSettingsActivity</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">PrivacySettingsActivity</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">PrivateVolumeForgetActivity</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">PrivateVolumeSettingsActivity</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">PublicVolumeSettingsActivity</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">RunningServicesActivity</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">SavedAccessPointsSettingsActivity</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">ScreenLockSuggestionActivity</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">ChooseLockGeneric</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">SecuritySettingsActivity</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">SimSettingsActivity</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">SimStatusActivity</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">SoundSettingsActivity</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">SpellCheckersSettingsActivity</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">StatusActivity</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">StorageSettingsActivity</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">StorageUseActivity</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">SystemSettings</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">TestingSettingsActivity</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">TetherSettingsActivity</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">TextToSpeechSettingsActivity</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">TopLevelSettings</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">TrustedCredentialsSettingsActivity</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">UsageAccessSettingsActivity</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">UserDictionarySettingsActivity</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">UserSettingsActivity</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">VpnSettingsActivity</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">VrListenersSettingsActivity</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">WallpaperSettingsActivity</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">WallpaperSuggestionActivity</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">WifiAPITestActivity</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">WifiCallingSettingsActivity</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">WifiCallingSuggestionActivity</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">WifiDisplaySettingsActivity</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">WifiInfoActivity</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">WifiP2pSettingsActivity</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">WifiSettingsActivity</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">WirelessSettings</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">WirelessSettingsActivity</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">WriteSettingsActivity</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">ZenAccessSettingsActivity</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">ZenModeAutomationSettingsActivity</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">ZenModeAutomationSuggestionActivity</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">ZenModeEventRuleSettingsActivity</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">ZenModeExternalRuleSettingsActivity</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">ZenModePrioritySettingsActivity</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">ZenModeScheduleRuleSettingsActivity</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">ZenModeSettingsActivity</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">ZenModeVisualInterruptionSettingsActivity</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class">  </span>&#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>Settings.java定义了大量静态内部类，没有任何跟界面UI相关的内容。这时候我就很困惑了，跳转到无障碍服务设置界面的内部实现是什么样的，不过从源码上看应该是AccessibilitySettingsActivity这个类，其继承自SettingsActivity类，所以继续跟踪。</p>
<h2 id="SettingsActivity"><a href="#SettingsActivity" class="headerlink" title="SettingsActivity"></a>SettingsActivity</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SettingsActivity</span> <span class="keyword">extends</span> <span class="title">SettingsDrawerActivity</span></span></span><br><span class="line"><span class="class">  <span class="keyword">implements</span> <span class="title">PreferenceManager</span>.<span class="title">OnPreferenceTreeClickListener</span>, <span class="title">PreferenceFragment</span>.<span class="title">OnPreferenceStartFragmentCallback</span>, <span class="title">ButtonBarHandler</span>, <span class="title">FragmentManager</span>.<span class="title">OnBackStackChangedListener</span>, <span class="title">SearchView</span>.<span class="title">OnQueryTextListener</span>, <span class="title">SearchView</span>.<span class="title">OnCloseListener</span>, <span class="title">MenuItemCompat</span>.<span class="title">OnActionExpandListener</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br></pre></td></tr></table></figure>
<p>SettingsDrawerActivity类最终继承自Activity，所以我们应该从onCreate()入手。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">  <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle paramBundle)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">super</span>.onCreate(paramBundle);</span><br><span class="line">    System.currentTimeMillis();</span><br><span class="line">    Object localObject = Settings.Secure.getUriFor(<span class="string">"mz_current_power_mode"</span>);</span><br><span class="line">    getContentResolver().registerContentObserver((Uri)localObject, <span class="keyword">false</span>, <span class="keyword">this</span>.mPowerSaveObserver, -<span class="number">1</span>);</span><br><span class="line"><span class="comment">// Should happen before any call to getIntent()</span></span><br><span class="line">    getMetaData();</span><br><span class="line">    localObject = getIntent();</span><br></pre></td></tr></table></figure></p>
<p>这里有个获取MetaData的方法，我们看一下这个方法的具体实现，同时我们从注释还可以看到这个方法需要在调用getIntent()之前进行调用。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">getMetaData</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">try</span></span><br><span class="line">  &#123;</span><br><span class="line">    ActivityInfo localActivityInfo = getPackageManager().getActivityInfo(getComponentName(), PackageManager.GET_META_DATA);</span><br><span class="line">    <span class="keyword">if</span> (localActivityInfo != <span class="keyword">null</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> (localActivityInfo.metaData == <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">this</span>.mFragmentClass = localActivityInfo.metaData.getString(<span class="string">"com.android.settings.FRAGMENT_CLASS"</span>);</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">catch</span> (PackageManager.NameNotFoundException localNameNotFoundException)</span><br><span class="line">  &#123;</span><br><span class="line">    Log.d(<span class="string">"Settings"</span>, <span class="string">"Cannot get Metadata for: "</span> + getComponentName().toString());</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>这个函数的作用就是从Activity标签中获取meta-data中key为<figure class="highlight plain"><figcaption><span>。所以我们应该再去AndroidManifest.xml查看AccessibilitySettingsActivity相关内容，具体如下：</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">```java</span><br><span class="line">        &lt;activity android:configChanges=&quot;keyboardHidden|orientation|screenSize&quot; android:icon=&quot;@drawable/mz_function_list_ic_accessibility&quot; android:label=&quot;@string/accessibility_settings&quot; android:name=&quot;com.android.settings.Settings$AccessibilitySettingsActivity&quot; android:taskAffinity=&quot;&quot;&gt;</span><br><span class="line">            &lt;intent-filter android:priority=&quot;1&quot;&gt;</span><br><span class="line">                &lt;action android:name=&quot;android.settings.ACCESSIBILITY_SETTINGS&quot;/&gt;</span><br><span class="line">                &lt;category android:name=&quot;android.intent.category.DEFAULT&quot;/&gt;</span><br><span class="line">            &lt;/intent-filter&gt;</span><br><span class="line">            &lt;intent-filter&gt;</span><br><span class="line">                &lt;action android:name=&quot;android.intent.action.VIEW&quot;/&gt;</span><br><span class="line">                &lt;category android:name=&quot;android.intent.category.DEFAULT&quot;/&gt;</span><br><span class="line">                &lt;category android:name=&quot;android.intent.category.BROWSABLE&quot;/&gt;</span><br><span class="line">                &lt;data android:host=&quot;com.android.settings&quot; android:path=&quot;/accessibility_settings&quot; android:scheme=&quot;flyme_3dtouch&quot;/&gt;</span><br><span class="line">            &lt;/intent-filter&gt;</span><br><span class="line">            &lt;intent-filter&gt;</span><br><span class="line">                &lt;action android:name=&quot;android.intent.action.MAIN&quot;/&gt;</span><br><span class="line">                &lt;category android:name=&quot;android.intent.category.DEFAULT&quot;/&gt;</span><br><span class="line">                &lt;category android:name=&quot;android.intent.category.VOICE_LAUNCH&quot;/&gt;</span><br><span class="line">                &lt;category android:name=&quot;com.android.settings.SHORTCUT&quot;/&gt;</span><br><span class="line">            &lt;/intent-filter&gt;</span><br><span class="line">            &lt;intent-filter android:priority=&quot;3&quot;&gt;</span><br><span class="line">                &lt;action android:name=&quot;com.android.settings.action.SETTINGS&quot;/&gt;</span><br><span class="line">            &lt;/intent-filter&gt;</span><br><span class="line">            &lt;meta-data android:name=&quot;com.android.settings.category&quot; android:value=&quot;com.android.settings.category.system&quot;/&gt;</span><br><span class="line">            &lt;meta-data android:name=&quot;com.android.settings.FRAGMENT_CLASS&quot; android:value=&quot;com.meizu.settings.accessibility.FlymeAccessibilitySettings&quot;/&gt;</span><br><span class="line">            &lt;meta-data android:name=&quot;com.android.settings.PRIMARY_PROFILE_CONTROLLED&quot; android:value=&quot;true&quot;/&gt;</span><br><span class="line">            &lt;meta-data android:name=&quot;usagestats.event&quot; android:value=&quot;accessibility_settings-click&quot;/&gt;</span><br><span class="line">        &lt;/activity&gt;</span><br></pre></td></tr></table></figure></p>
<p>从上面可以看出mFragmentClass  = “com.meizu.settings.accessibility.FlymeAccessibilitySettings”。<br>找到了Fragment，就要看看它是怎么加载Fragment的，继续看onCreate函数，接下来就跟踪到了getIntent()方法：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> Intent <span class="title">getIntent</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  Intent localIntent1 = <span class="keyword">super</span>.getIntent();</span><br><span class="line">  Object localObject = getStartingFragmentClass(localIntent1);</span><br><span class="line">  <span class="keyword">if</span> (localObject != <span class="keyword">null</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    Intent localIntent2 = <span class="keyword">new</span> Intent(localIntent1);</span><br><span class="line">    localIntent2.putExtra(<span class="string">":settings:show_fragment"</span>, (String)localObject);</span><br><span class="line">    localObject = localIntent1.getExtras();</span><br><span class="line">    <span class="keyword">if</span> (localObject != <span class="keyword">null</span>) &#123;&#125;</span><br><span class="line">    <span class="keyword">for</span> (localObject = <span class="keyword">new</span> Bundle((Bundle)localObject);; localObject = <span class="keyword">new</span> Bundle())</span><br><span class="line">    &#123;</span><br><span class="line">      ((Bundle)localObject).putParcelable(<span class="string">"intent"</span>, localIntent1);</span><br><span class="line">      localIntent2.putExtra(<span class="string">":settings:show_fragment_args"</span>, (Bundle)localObject);</span><br><span class="line">      <span class="keyword">return</span> localIntent2;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> localIntent1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> String <span class="title">getStartingFragmentClass</span><span class="params">(Intent paramIntent)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">this</span>.mFragmentClass != <span class="keyword">null</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.mFragmentClass;</span><br><span class="line">  &#125;</span><br><span class="line">  String str = paramIntent.getComponent().getClassName();</span><br><span class="line">  <span class="keyword">if</span> (str.equals(getClass().getName())) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ((!<span class="string">"com.android.settings.ManageApplications"</span>.equals(str)) &amp;&amp; (!<span class="string">"com.android.settings.RunningServices"</span>.equals(str)))</span><br><span class="line">  &#123;</span><br><span class="line">    paramIntent = str;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="string">"com.android.settings.applications.StorageUse"</span>.equals(str)) &#123;&#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    paramIntent = ManageApplications.class.getName();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> paramIntent;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>从源码可以看出getIntent()就是返回了一个Intent，并传了一个参数（key为<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">分析了getIntent，继续往下看onCreate函数，看这个intent是如何使用的。</span><br><span class="line">```java</span><br><span class="line">      if (!this.mIsShowingDashboard)</span><br><span class="line">      &#123;</span><br><span class="line">        this.mDisplaySearch = false;</span><br><span class="line">        if (this.mIsShortcut) &#123;</span><br><span class="line">          this.mDisplayHomeAsUpEnabled = bool;</span><br><span class="line">        &#125;</span><br><span class="line">        for (;;)</span><br><span class="line">        &#123;</span><br><span class="line">          setTitleFromIntent((Intent)localObject);</span><br><span class="line">          switchToFragment(str1, ((Intent)localObject).getBundleExtra(&quot;:settings:show_fragment_args&quot;), true, false, this.mInitialTitleResId, this.mInitialTitle, false);</span><br><span class="line">          break;</span><br><span class="line">          if (bool)</span><br><span class="line">          &#123;</span><br><span class="line">            this.mDisplayHomeAsUpEnabled = true;</span><br><span class="line">            this.mDisplaySearch = false;</span><br><span class="line">          &#125;</span><br><span class="line">          else</span><br><span class="line">          &#123;</span><br><span class="line">            this.mDisplayHomeAsUpEnabled = true;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br></pre></td></tr></table></figure></p>
<p>从上面源码大概能看出关键部分应该是switchToFragment()函数。我们再看一下switchToFragment的实现：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> Fragment <span class="title">switchToFragment</span><span class="params">(String paramString, Bundle paramBundle, <span class="keyword">boolean</span> paramBoolean1, <span class="keyword">boolean</span> paramBoolean2, <span class="keyword">int</span> paramInt, CharSequence paramCharSequence, <span class="keyword">boolean</span> paramBoolean3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (FlymeDashboardSummary.isConnectivitySettingsFragment(paramString))</span><br><span class="line">  &#123;</span><br><span class="line">    FlymeDashboardSummary.startWithFragment(<span class="keyword">this</span>, paramString, paramBundle, <span class="keyword">null</span>, <span class="number">0</span>, <span class="keyword">this</span>.mInitialTitleResId, <span class="keyword">this</span>.mInitialTitle);</span><br><span class="line">    finish();</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ((!paramBoolean1) || (isValidFragment(paramString)))</span><br><span class="line">  &#123;</span><br><span class="line">    paramString = Fragment.instantiate(<span class="keyword">this</span>, paramString, paramBundle);</span><br><span class="line">    paramBundle = getFragmentManager().beginTransaction();</span><br><span class="line">    paramBundle.replace(<span class="keyword">this</span>.mMainContentId, paramString);</span><br><span class="line">    <span class="keyword">if</span> (paramBoolean3) &#123;</span><br><span class="line">      TransitionManager.beginDelayedTransition(<span class="keyword">this</span>.mContent);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (paramBoolean2) &#123;</span><br><span class="line">      paramBundle.addToBackStack(<span class="string">":settings:prefs"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (paramInt &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="keyword">break</span> label145;</span><br><span class="line">    &#125;</span><br><span class="line">    paramBundle.setBreadCrumbTitle(paramInt);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> (;;)</span><br><span class="line">  &#123;</span><br><span class="line">    paramBundle.commitAllowingStateLoss();</span><br><span class="line">    getFragmentManager().executePendingTransactions();</span><br><span class="line">    <span class="keyword">return</span> paramString;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">"Invalid fragment for this activity: "</span> + paramString);</span><br><span class="line">    label145:</span><br><span class="line">    <span class="keyword">if</span> (paramCharSequence != <span class="keyword">null</span>) &#123;</span><br><span class="line">      paramBundle.setBreadCrumbTitle(paramCharSequence);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>从上面可以看出先通过指定的mFragment实例化fragment，然后通过FragmentTransaction的replace方法加载fragment。<br>通过上述分析，我们知道了Settings.apk如何通过隐式的Intent调转到对应的Activity布局。<br><em>当然到这一步还是不能帮我解决问题，还是没有解决魅族手机无法通过常见的方法跳到系统设置的无障碍服务的问题。</em></p>
<h2 id="FlymeAccessibilitySettings类"><a href="#FlymeAccessibilitySettings类" class="headerlink" title="FlymeAccessibilitySettings类"></a>FlymeAccessibilitySettings类</h2><p>从上面的分析我们已经能够知道魅族手机设置–&gt;辅助功能对应的Fragment是FlymeAccessibilitySettings这个类，源码如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FlymeAccessibilitySettings</span>  <span class="keyword">extends</span> <span class="title">SettingsPreferenceFragment</span> </span></span><br><span class="line"><span class="class"><span class="keyword">implements</span> <span class="title">DialogInterface</span>.<span class="title">OnClickListener</span>, <span class="title">Preference</span>.<span class="title">OnPreferenceChangeListener</span>, <span class="title">Indexable</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">....</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SettingsPreferenceFragment</span> <span class="keyword">extends</span> <span class="title">PreferenceFragment</span></span></span><br><span class="line"><span class="class">  <span class="keyword">implements</span> <span class="title">DialogCreatable</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>可以看出FlymeAccessibilitySettings是继承自PreferenceFragment类，它一个最重要的方法是调用addPreferencesFromResource()参数为xml资源id，来加载静态xml资源文件 （在res文件夹下新建xml文件夹，再在xml文件中新建对应的xml资源），完成Preference界面的构建。所以我们可以依次找到FlymeAccessibilitySettings对应的xml资源文件为mz_accessibility_settings.xml，内容如下：<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=<span class="string">"1.0"</span> encoding=<span class="string">"utf-8"</span>?&gt;</span><br><span class="line">&lt;android.preference.PreferenceScreen android:title=<span class="string">"@string/accessibility_settings"</span></span><br><span class="line">  xmlns:android=<span class="string">"http://schemas.android.com/apk/prv/res/android"</span>&gt;</span><br><span class="line">    &lt;android.preference.PreferenceCategory android:title=<span class="string">"@string/interactive"</span> android:key=<span class="string">"interactive"</span> /&gt;</span><br><span class="line">    &lt;android.preference.Preference android:title=<span class="string">"@string/multi_task_title"</span> android:key=<span class="string">"multi_task"</span> android:widgetLayout=<span class="string">"@167968832"</span> android:fragment=<span class="string">"com.meizu.settings.accessibility.FlymeMultiTaskFragment"</span> /&gt;</span><br><span class="line">    &lt;android.preference.Preference android:title=<span class="string">"@string/quick_wakeup_title"</span> android:key=<span class="string">"quick_wakeup"</span> android:summary=<span class="string">"@string/quick_wakeup_tips"</span> android:widgetLayout=<span class="string">"@167968832"</span> android:fragment=<span class="string">"com.meizu.settings.accessibility.FlymeQuickWakeupFragment"</span> /&gt;</span><br><span class="line">    &lt;android.preference.Preference android:title=<span class="string">"@string/smart_voice_wakeup"</span> android:key=<span class="string">"smart_voice_wakeup"</span> android:summary=<span class="string">"@string/smart_voice_wakeup_tips"</span> android:widgetLayout=<span class="string">"@167968832"</span> /&gt;</span><br><span class="line">    &lt;android.preference.Preference android:title=<span class="string">"@string/smart_touch_title"</span> android:key=<span class="string">"smart_touch"</span> android:summary=<span class="string">"@string/smart_touch_tips"</span> android:widgetLayout=<span class="string">"@167968832"</span> android:fragment=<span class="string">"com.meizu.settings.accessibility.FlymeSmartTouchFragment"</span> /&gt;</span><br><span class="line">    &lt;android.preference.Preference android:title=<span class="string">"@string/force_touch_title"</span> android:key=<span class="string">"force_touch"</span> android:widgetLayout=<span class="string">"@167968832"</span> android:fragment=<span class="string">"com.meizu.settings.accessibility.ForceTouchSettingsFragment"</span> /&gt;</span><br><span class="line">    &lt;android.preference.PreferenceCategory android:title=<span class="string">"@string/header_category_lab"</span> android:key=<span class="string">"interactive"</span> /&gt;</span><br><span class="line">    &lt;android.preference.Preference android:title=<span class="string">"@string/safe_family_title"</span> android:key=<span class="string">"safe_family"</span> android:widgetLayout=<span class="string">"@167968832"</span> /&gt;</span><br><span class="line">    &lt;android.preference.Preference android:title=<span class="string">"@string/children_mode_title"</span> android:key=<span class="string">"children_mode"</span> android:widgetLayout=<span class="string">"@167968832"</span> /&gt;</span><br><span class="line">    &lt;android.preference.Preference android:title=<span class="string">"@string/app_clone_title"</span> android:key=<span class="string">"app_clone"</span> android:widgetLayout=<span class="string">"@167968832"</span> android:fragment=<span class="string">"com.meizu.settings.appclone.AppCloneSettings"</span> /&gt;</span><br><span class="line">    &lt;android.preference.Preference android:title=<span class="string">"@string/game_mode_title"</span> android:key=<span class="string">"game_mode"</span> android:widgetLayout=<span class="string">"@167968832"</span> android:fragment=<span class="string">"com.meizu.settings.accessibility.GameModeSettings"</span> /&gt;</span><br><span class="line">    &lt;android.preference.Preference android:title=<span class="string">"@string/red_envelope_title"</span> android:key=<span class="string">"red_envelope_assistant"</span> android:widgetLayout=<span class="string">"@167968832"</span> android:fragment=<span class="string">"com.meizu.settings.notificationstatusbar.FlymeRedEnvelopeAssistantSettings"</span> /&gt;</span><br><span class="line">    &lt;android.preference.Preference android:title=<span class="string">"@string/flashlamp_effects_title"</span> android:key=<span class="string">"flashlamp_effects"</span> android:widgetLayout=<span class="string">"@167968832"</span> android:fragment=<span class="string">"com.meizu.settings.accessibility.FlymeFlashLampEffectsSettings"</span> /&gt;</span><br><span class="line">    &lt;android.preference.Preference android:title=<span class="string">"@string/classic_mode"</span> android:key=<span class="string">"classic_mode"</span> android:widgetLayout=<span class="string">"@167968832"</span> android:fragment=<span class="string">"com.meizu.settings.accessibility.FlymeClassicModeFragment"</span> /&gt;</span><br><span class="line">    &lt;android.preference.PreferenceCategory android:title=<span class="string">"@string/accessiblity_category_system"</span> android:key=<span class="string">"accessiblity_category_system"</span> /&gt;</span><br><span class="line">    &lt;ListPreference android:persistent=<span class="string">"false"</span> android:entries=<span class="string">"@array/home_key_behavior_double_click_entries"</span> android:title=<span class="string">"@string/home_key_behavior_double_click"</span> android:key=<span class="string">"home_double_click"</span> android:entryValues=<span class="string">"@array/home_key_behavior_double_click_values"</span> /&gt;</span><br><span class="line">    &lt;ListPreference android:persistent=<span class="string">"false"</span> android:entries=<span class="string">"@array/home_key_behavior_entries"</span> android:title=<span class="string">"@string/home_key_behavior"</span> android:key=<span class="string">"home_long_press"</span> android:entryValues=<span class="string">"@array/home_key_behavior_values"</span> /&gt;</span><br><span class="line">    &lt;ListPreference android:persistent=<span class="string">"false"</span> android:entries=<span class="string">"@array/keyboard_back_behavior_entries"</span> android:title=<span class="string">"@string/keyboard_back_behavior"</span> android:key=<span class="string">"keyboard_back_behavior"</span> android:entryValues=<span class="string">"@array/keyboard_back_behavior_values"</span> /&gt;</span><br><span class="line">    &lt;com.meizu.common.preference.SwitchPreference android:persistent=<span class="string">"false"</span> android:title=<span class="string">"@string/headset_middlekey_wakeup"</span> android:key=<span class="string">"headset_middlekey_wakeup"</span> android:summary=<span class="string">"@string/headset_middlekey_wakeup_summay"</span> /&gt;</span><br><span class="line">    &lt;com.meizu.common.preference.SwitchPreference android:title=<span class="string">"@string/light_feedback_enable_title"</span> android:key=<span class="string">"light_feedback"</span> android:defaultValue=<span class="string">"true"</span> /&gt;</span><br><span class="line">    &lt;com.meizu.common.preference.SwitchPreference android:title=<span class="string">"@string/keyguard_palm_rejection_title"</span> android:key=<span class="string">"palm_rejection"</span> android:summary=<span class="string">"@string/keyguard_palm_rejection_summary"</span> android:defaultValue=<span class="string">"true"</span> /&gt;</span><br><span class="line">    &lt;com.meizu.common.preference.SwitchPreference android:title=<span class="string">"@string/hall_switch_title"</span> android:key=<span class="string">"use_cover"</span> android:summary=<span class="string">"@string/hall_switch_summary"</span> android:defaultValue=<span class="string">"true"</span> /&gt;</span><br><span class="line">    &lt;com.meizu.common.preference.SwitchPreference android:title=<span class="string">"@string/mcharge_title"</span> android:key=<span class="string">"fast_charge"</span> android:defaultValue=<span class="string">"true"</span> /&gt;</span><br><span class="line">    &lt;android.preference.Preference android:title=<span class="string">"@string/search_settings_title"</span> android:key=<span class="string">"search_settings"</span> android:widgetLayout=<span class="string">"@167968832"</span> /&gt;</span><br><span class="line">    &lt;android.preference.Preference android:title=<span class="string">"@string/scheduled_power_onandoff_title"</span> android:key=<span class="string">"scheduled_power"</span> android:widgetLayout=<span class="string">"@167968832"</span> android:fragment=<span class="string">"com.meizu.settings.scheduledpower.ScheduledPowerFragment"</span> /&gt;</span><br><span class="line">    &lt;android.preference.Preference android:title=<span class="string">"@string/drive_mode_title"</span> android:key=<span class="string">"drive_mode"</span> android:widgetLayout=<span class="string">"@167968832"</span> android:fragment=<span class="string">"com.meizu.settings.drivemode.MzDriveModeFragment"</span> /&gt;</span><br><span class="line">    &lt;android.preference.PreferenceScreen android:title=<span class="string">"@string/accessible"</span> android:key=<span class="string">"accessible_settings"</span> android:fragment=<span class="string">"com.android.settings.accessibility.AccessibilitySettings"</span> /&gt;</span><br><span class="line">    &lt;com.meizu.settings.calibration.ProximityCalibraton android:title=<span class="string">"@string/sensor_adjust_title"</span> android:key=<span class="string">"sensor_adjust_proximity"</span> /&gt;</span><br><span class="line">    &lt;com.meizu.settings.calibration.GsensorCalibration android:title=<span class="string">"@string/gsensor_calibrate_text"</span> android:key=<span class="string">"sensor_adjust_gsensor"</span> /&gt;</span><br><span class="line">    &lt;android.preference.Preference android:title=<span class="string">"@string/development_settings_title"</span> android:key=<span class="string">"development_settings"</span> android:widgetLayout=<span class="string">"@167968832"</span> android:fragment=<span class="string">"com.android.settings.DevelopmentSettings"</span> /&gt;</span><br><span class="line">    &lt;com.meizu.common.preference.SwitchPreference android:title=<span class="string">"@string/data_collection_title"</span> android:key=<span class="string">"data_collection"</span> /&gt;</span><br><span class="line">&lt;/android.preference.PreferenceScreen&gt;</span><br></pre></td></tr></table></figure></p>
<p>对照着手机界面，我们可以确认这个xml文件就是FlymeAccessibilitySettings类的静态资源文件，从中我们可以找到魅族手机无障碍服务对应的Fragment：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;android.preference.PreferenceScreen android:title=<span class="string">"@string/accessible"</span> android:key=<span class="string">"accessible_settings"</span> android:fragment=<span class="string">"com.android.settings.accessibility.AccessibilitySettings"</span> /&gt;</span><br></pre></td></tr></table></figure></p>
<p>在PreferenceFragment中点击列表项的点击监听方法为onPreferenceTreeClick()；在FlymeAccessibilitySettings类中的源码如下：<br> <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onPreferenceTreeClick</span><span class="params">(PreferenceScreen paramPreferenceScreen, Preference paramPreference)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> k = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">int</span> m = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">int</span> j = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">this</span>.mUsageStatsProxy.reportData(<span class="string">"AccessibilitySettings"</span>, paramPreference.getKey(), paramPreference);</span><br><span class="line">  <span class="keyword">if</span> (paramPreference == <span class="keyword">this</span>.mHomeLightSwitchPreference)</span><br><span class="line">  &#123;</span><br><span class="line">    paramPreferenceScreen = <span class="keyword">this</span>.mContentResolver;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.mHomeLightSwitchPreference.isChecked()) &#123;</span><br><span class="line">      i = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    Settings.System.putInt(paramPreferenceScreen, <span class="string">"light_feedback_enabled"</span>, i);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (paramPreference == <span class="keyword">this</span>.mDataCollectionSwitch)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.mDataCollectionSwitch.isChecked())</span><br><span class="line">    &#123;</span><br><span class="line">      warnDataCollection();</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    Settings.System.putInt(<span class="keyword">this</span>.mContentResolver, <span class="string">"meizu_data_collection"</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (paramPreference == <span class="keyword">this</span>.mSearchPreference)</span><br><span class="line">  &#123;</span><br><span class="line">    paramPreferenceScreen = <span class="keyword">new</span> Intent();</span><br><span class="line">    paramPreferenceScreen.setAction(<span class="string">"com.meizu.net.search.setting"</span>);</span><br><span class="line">    paramPreferenceScreen.addFlags(<span class="number">335544320</span>);</span><br><span class="line">    <span class="keyword">try</span></span><br><span class="line">    &#123;</span><br><span class="line">      startActivity(paramPreferenceScreen);</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span> (ActivityNotFoundException paramPreferenceScreen)</span><br><span class="line">    &#123;</span><br><span class="line">      Log.e(<span class="string">"AccessibilitySettings"</span>, <span class="string">"ActivityNotFoundException for search preference"</span>);</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (paramPreference == <span class="keyword">this</span>.mHeadsetMiddleKeyWakeupPreference)</span><br><span class="line">  &#123;</span><br><span class="line">    paramPreferenceScreen = <span class="keyword">this</span>.mContentResolver;</span><br><span class="line">    i = k;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.mHeadsetMiddleKeyWakeupPreference.isChecked()) &#123;</span><br><span class="line">      i = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    Settings.System.putInt(paramPreferenceScreen, <span class="string">"headset_middle_key_wakeup"</span>, i);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (paramPreference == <span class="keyword">this</span>.mSmartVoiceWakeupPreference) &#123;</span><br><span class="line">    <span class="keyword">try</span></span><br><span class="line">    &#123;</span><br><span class="line">      paramPreferenceScreen = <span class="keyword">new</span> Intent(<span class="string">"com.mediatek.voicecommand.VOICE_CONTROL_SETTINGS"</span>);</span><br><span class="line">      paramPreferenceScreen.addFlags(<span class="number">335544320</span>);</span><br><span class="line">      startActivity(paramPreferenceScreen);</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span> (ActivityNotFoundException paramPreferenceScreen)</span><br><span class="line">    &#123;</span><br><span class="line">      Log.e(<span class="string">"AccessibilitySettings"</span>, <span class="string">"ActivityNotFoundException for MTK voice wakeup preference"</span>);</span><br><span class="line">      startFragment(<span class="keyword">this</span>, <span class="string">"com.meizu.settings.accessibility.FlymeSmartVoiceWakeupFragment"</span>, <span class="number">2131627644</span>, -<span class="number">1</span>, <span class="keyword">null</span>);</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">this</span>.mFlymeInnovation.onPreferenceTreeClick(paramPreferenceScreen, paramPreference)) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (paramPreference == <span class="keyword">this</span>.mPalmRejection)</span><br><span class="line">  &#123;</span><br><span class="line">    paramPreferenceScreen = <span class="keyword">this</span>.mContentResolver;</span><br><span class="line">    i = m;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.mPalmRejection.isChecked()) &#123;</span><br><span class="line">      i = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    Settings.System.putInt(paramPreferenceScreen, <span class="string">"keyguard_palm_rejection"</span>, i);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (paramPreference == <span class="keyword">this</span>.mFastCharge) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="keyword">this</span>.mFastCharge.isChecked())</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">this</span>.mChargeDialog = <span class="keyword">new</span> AlertDialog.Builder(<span class="keyword">this</span>.mContext, <span class="number">5</span>).setMessage(<span class="number">2131628228</span>).setPositiveButton(<span class="number">17039379</span>, <span class="keyword">this</span>).setNegativeButton(<span class="number">17039369</span>, <span class="keyword">this</span>).show();</span><br><span class="line">      <span class="keyword">this</span>.mChargeDialog.setOnDismissListener(<span class="keyword">new</span> DialogInterface.OnDismissListener()</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onDismiss</span><span class="params">(DialogInterface paramAnonymousDialogInterface)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">          <span class="keyword">boolean</span> bool = <span class="keyword">true</span>;</span><br><span class="line">          paramAnonymousDialogInterface = FlymeAccessibilitySettings.-get4(FlymeAccessibilitySettings.<span class="keyword">this</span>);</span><br><span class="line">          <span class="keyword">if</span> (Settings.Global.getInt(FlymeAccessibilitySettings.-get0(FlymeAccessibilitySettings.<span class="keyword">this</span>), <span class="string">"mz_fast_charge"</span>, <span class="number">1</span>) == <span class="number">1</span>) &#123;&#125;</span><br><span class="line">          <span class="keyword">for</span> (;;)</span><br><span class="line">          &#123;</span><br><span class="line">            paramAnonymousDialogInterface.setChecked(bool);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">            bool = <span class="keyword">false</span>;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> (;;)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">super</span>.onPreferenceTreeClick(paramPreferenceScreen, paramPreference);</span><br><span class="line">    Settings.Global.putInt(<span class="keyword">this</span>.mContentResolver, <span class="string">"mz_fast_charge"</span>, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">continue</span>;</span><br><span class="line">    <span class="keyword">if</span> (paramPreference == <span class="keyword">this</span>.mHallSwitch)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">boolean</span> bool = <span class="keyword">this</span>.mHallSwitch.isChecked();</span><br><span class="line">      ContentResolver localContentResolver = <span class="keyword">this</span>.mContentResolver;</span><br><span class="line">      <span class="keyword">if</span> (bool) &#123;&#125;</span><br><span class="line">      <span class="keyword">for</span> (i = j;; i = <span class="number">0</span>)</span><br><span class="line">      &#123;</span><br><span class="line">        Settings.System.putInt(localContentResolver, <span class="string">"hall_switch"</span>, i);</span><br><span class="line">        <span class="keyword">this</span>.mUsageStatsProxy.reportData(FlymeAccessibilitySettings.class.getSimpleName(), paramPreference.getKey(), paramPreference);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (paramPreference == <span class="keyword">this</span>.mSafeFamilyPreference) &#123;</span><br><span class="line">      startActivity(getBreakingScamIntent());</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>从上面我们可以分析出对辅助功能界面各个item的处理，不过最重要的对无障碍的处理是<figure class="highlight plain"><figcaption><span>paramPreference)```，继续跟踪下去，FlymeAccessibilitySettings的父类为SettingsPreferenceFragment，源码如下：</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">```java</span><br><span class="line">  public boolean onPreferenceTreeClick(PreferenceScreen paramPreferenceScreen, Preference paramPreference)</span><br><span class="line">  &#123;</span><br><span class="line">    if (paramPreference.getFragment() != null) &#123;</span><br><span class="line">      return ((SettingsActivity)getActivity()).onPreferenceStartFragment(this, paramPreference);</span><br><span class="line">    &#125;</span><br><span class="line">    return super.onPreferenceTreeClick(paramPreferenceScreen, paramPreference);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></p>
<p>因为无障碍服务对应的是另一个Fragment，所以进入if块，调用onPreferenceStartFragment()，源码如下：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onPreferenceStartFragment</span><span class="params">(SettingsPreferenceFragment paramSettingsPreferenceFragment, android.preference.Preference paramPreference)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  paramSettingsPreferenceFragment = paramPreference.getTitle();</span><br><span class="line">  <span class="keyword">if</span> (paramPreference.getFragment().equals(WallpaperTypeSettings.class.getName())) &#123;</span><br><span class="line">    paramSettingsPreferenceFragment = getString(<span class="number">2131625303</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  startPreferencePanel(paramPreference.getFragment(), paramPreference.getExtras(), -<span class="number">1</span>, paramSettingsPreferenceFragment, <span class="keyword">null</span>, <span class="number">0</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">startPreferencePanel</span><span class="params">(String paramString, Bundle paramBundle, <span class="keyword">int</span> paramInt1, CharSequence paramCharSequence, Fragment paramFragment, <span class="keyword">int</span> paramInt2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  String str = <span class="keyword">null</span>;</span><br><span class="line">  <span class="keyword">if</span> (paramInt1 &lt; <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (paramCharSequence == <span class="keyword">null</span>) &#123;</span><br><span class="line">      <span class="keyword">break</span> label39;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  label39:</span><br><span class="line">  <span class="keyword">for</span> (str = paramCharSequence.toString();; str = <span class="string">""</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    Utils.startWithFragment(<span class="keyword">this</span>, paramString, paramBundle, paramFragment, paramInt2, paramInt1, str, <span class="keyword">this</span>.mIsShortcut);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>到这一步可以发现最终调用的是<figure class="highlight plain"><figcaption><span>too young too native</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">继续往下看：</span><br><span class="line">```java</span><br><span class="line">  public static void startWithFragment(Context paramContext, String paramString, Bundle paramBundle, Fragment paramFragment, int paramInt1, int paramInt2, CharSequence paramCharSequence, boolean paramBoolean)</span><br><span class="line">  &#123;</span><br><span class="line">    paramString = onBuildStartFragmentIntent(paramContext, paramString, paramBundle, null, paramInt2, paramCharSequence, paramBoolean);</span><br><span class="line">    if (paramFragment == null)</span><br><span class="line">    &#123;</span><br><span class="line">      paramContext.startActivity(paramString);</span><br><span class="line">      return;</span><br><span class="line">    &#125;</span><br><span class="line">    paramFragment.startActivityForResult(paramString, paramInt1);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  public static Intent onBuildStartFragmentIntent(Context paramContext, String paramString1, Bundle paramBundle, String paramString2, int paramInt, CharSequence paramCharSequence, boolean paramBoolean)</span><br><span class="line">  &#123;</span><br><span class="line">    Intent localIntent = new Intent(&quot;android.intent.action.MAIN&quot;);</span><br><span class="line">    localIntent.setClass(paramContext, SubSettings.class);</span><br><span class="line">    localIntent.putExtra(&quot;:settings:show_fragment&quot;, paramString1);</span><br><span class="line">    localIntent.putExtra(&quot;:settings:show_fragment_args&quot;, paramBundle);</span><br><span class="line">    localIntent.putExtra(&quot;:settings:show_fragment_title_res_package_name&quot;, paramString2);</span><br><span class="line">    localIntent.putExtra(&quot;:settings:show_fragment_title_resid&quot;, paramInt);</span><br><span class="line">    localIntent.putExtra(&quot;:settings:show_fragment_title&quot;, paramCharSequence);</span><br><span class="line">    localIntent.putExtra(&quot;:settings:show_fragment_as_shortcut&quot;, paramBoolean);</span><br><span class="line">    return localIntent;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></p>
<p>不难发现从调用无障碍服务的方式是startActivityForResult()，在这个之前会先调用onBuildStartFragmentInten()构造一个intent。首先我们看到方法内部所调用的Activity为SubSettings类，源码如下：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SubSettings</span> <span class="keyword">extends</span> <span class="title">SettingsActivity</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">protected</span> <span class="keyword">boolean</span> <span class="title">isValidFragment</span><span class="params">(String paramString)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    Log.d(<span class="string">"SubSettings"</span>, <span class="string">"Launching fragment "</span> + paramString);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onNavigateUp</span><span class="params">()</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    finish();</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>SubSettings继承自SettingsActivity，我们在之前的分析已经能得出SettingsActivity加载Fragment的方式是从AndroidManifest.xml的Activity标签中获取meta-data中key为<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">```java</span><br><span class="line">        &lt;activity android:configChanges=&quot;keyboardHidden|orientation|screenSize&quot; android:exported=&quot;true&quot; android:name=&quot;com.android.settings.SubSettings&quot; android:parentActivityName=&quot;com.android.settings.Settings&quot; android:permission=&quot;com.meizu.permission.SEARCH_SETTINGS&quot; android:screenOrientation=&quot;portrait&quot; android:taskAffinity=&quot;com.android.settings&quot;&gt;</span><br><span class="line">            &lt;intent-filter&gt;</span><br><span class="line">                &lt;action android:name=&quot;android.intent.action.SEARCH&quot;/&gt;</span><br><span class="line">            &lt;/intent-filter&gt;</span><br><span class="line">            &lt;meta-data android:name=&quot;android.app.searchable&quot; android:resource=&quot;@xml/searchable&quot;/&gt;</span><br><span class="line">        &lt;/activity&gt;</span><br></pre></td></tr></table></figure></p>
<p>并没有我们所需要的值，但在getIntent中我们可以发现intent值来自<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">代码如下：</span><br><span class="line">```java</span><br><span class="line">        intent.setAction(&quot;android.intent.action.SEARCH&quot;);</span><br><span class="line">        intent.setComponent(new ComponentName(&quot;com.android.settings&quot;, &quot;com.android.settings.SubSettings&quot;));</span><br><span class="line">        intent.putExtra(PreferenceActivity.EXTRA_SHOW_FRAGMENT, &quot;com.android.settings.accessibility.AccessibilitySettings&quot;);</span><br><span class="line">        startActivity(intent);</span><br></pre></td></tr></table></figure></p>
<p>因为跳转SubSettings这个Activity需要声明一个permission，所以我们必须在我们应用加上这个权限声明，但是这会引来另一个问题：<strong>Failure [INSTALL_FAILED_DUPLICATE_PERMISSION</strong>，这个错误的意思是正要安装的APP的自定义权限与手机上已有APP的自定义权限名字相同，但两个APP具有不同的签名信息导致安装失败。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/04/18/关于AlertDialog的小知识/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Forwards">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Forwards">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/04/18/关于AlertDialog的小知识/" itemprop="url">关于AlertDialog点击按钮弹窗自动dismiss的源码分析及解决方案</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-04-18T22:05:21+08:00">
                2018-04-18
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="关于AlertDialog点击按钮弹窗自动dismiss的源码分析及解决方案"><a href="#关于AlertDialog点击按钮弹窗自动dismiss的源码分析及解决方案" class="headerlink" title="关于AlertDialog点击按钮弹窗自动dismiss的源码分析及解决方案"></a>关于AlertDialog点击按钮弹窗自动dismiss的源码分析及解决方案</h1><p>前言：在使用AlertDialog时，发现即使没有调用dismiss()点击取消或者确定按钮对话框都会自动关闭，看了源码才发现，这一操作在源码已经写死了。</p>
<h2 id="源码分析"><a href="#源码分析" class="headerlink" title="源码分析"></a>源码分析</h2><p>首先我们先看下AlertDialog的一般用法：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">AlertDialog.Builder builder = <span class="keyword">new</span> AlertDialog.Builder(getActivity())</span><br><span class="line">		.setTitle(<span class="string">"提示"</span>)</span><br><span class="line">		.setMessage(featureContent)</span><br><span class="line">		.setPositiveButton(<span class="string">"确定"</span>, <span class="keyword">new</span> DialogInterface.OnClickListener() &#123;</span><br><span class="line">				<span class="meta">@Override</span></span><br><span class="line">				<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(DialogInterface dialog, <span class="keyword">int</span> which)</span> </span>&#123;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;);</span><br><span class="line">		AlertDialog dialog = builder.create();</span><br><span class="line">		dialog.setCancelable(<span class="keyword">true</span>);</span><br><span class="line">		dialog.setCanceledOnTouchOutside(<span class="keyword">true</span>);</span><br><span class="line">		dialog.show();</span><br></pre></td></tr></table></figure>
<p>AlertDialog采用Builder进行构造参数的配置，最后通过show()方法返回一个已配置的AlertDialog实例。<br>从API调用我们可以知道应该先从AlertDialog.Builder入手查起，看看Builder的构造器都做了什么。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">Builder</span><span class="params">(Context context)</span> </span>&#123;</span><br><span class="line">     <span class="keyword">this</span>(context, resolveDialogTheme(context, <span class="number">0</span>));</span><br><span class="line"> &#125;</span><br><span class="line">		</span><br><span class="line"> <span class="function"><span class="keyword">public</span> <span class="title">Builder</span><span class="params">(Context context, <span class="keyword">int</span> theme)</span> </span>&#123;</span><br><span class="line">     P = <span class="keyword">new</span> AlertController.AlertParams(<span class="keyword">new</span> ContextThemeWrapper(</span><br><span class="line">             context, resolveDialogTheme(context, theme)));</span><br><span class="line">     mTheme = theme;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure></p>
<p>接着分析builder.setPositiveButton()方法：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> Builder <span class="title">setPositiveButton</span><span class="params">(CharSequence text, <span class="keyword">final</span> OnClickListener listener)</span> </span>&#123;</span><br><span class="line">    P.mPositiveButtonText = text;</span><br><span class="line">    P.mPositiveButtonListener = listener;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>从上面的代码我们可以看出最终的操作都指向了AlertController这个类（AlertController类是Android的内部类，在com.android.internal.app包中，无法通过普通的方式访问，也无法在eclipse通过按Ctrl键跟踪进源代码），在AlertController的构造器中我们看到了一个Hanlder类：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">AlertController</span><span class="params">(Context context, DialogInterface di, Window window)</span> </span>&#123;</span><br><span class="line">      mContext = context;</span><br><span class="line">      mDialogInterface = di;</span><br><span class="line">      mWindow = window;</span><br><span class="line">      mHandler = <span class="keyword">new</span> ButtonHandler(di);</span><br><span class="line">...</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></p>
<p>再看下ButtonHandler的实现：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">ButtonHandler</span> <span class="keyword">extends</span> <span class="title">Handler</span> </span>&#123;</span><br><span class="line">    <span class="comment">// Button clicks have Message.what as the BUTTON&#123;1,2,3&#125; constant</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> MSG_DISMISS_DIALOG = <span class="number">1</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> WeakReference&lt;DialogInterface&gt; mDialog;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ButtonHandler</span><span class="params">(DialogInterface dialog)</span> </span>&#123;</span><br><span class="line">        mDialog = <span class="keyword">new</span> WeakReference&lt;DialogInterface&gt;(dialog);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handleMessage</span><span class="params">(Message msg)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">switch</span> (msg.what) &#123;</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">case</span> DialogInterface.BUTTON_POSITIVE:</span><br><span class="line">            <span class="keyword">case</span> DialogInterface.BUTTON_NEGATIVE:</span><br><span class="line">            <span class="keyword">case</span> DialogInterface.BUTTON_NEUTRAL:</span><br><span class="line">                ((DialogInterface.OnClickListener) msg.obj).onClick(mDialog.get(), msg.what);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">                </span><br><span class="line">            <span class="keyword">case</span> MSG_DISMISS_DIALOG:</span><br><span class="line">                ((DialogInterface) msg.obj).dismiss();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>在这里我们看到了熟悉的dismiss()方法。而在这个类的开头我们就发现了OnClickListener事件的实例：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">View.OnClickListener mButtonHandler = <span class="keyword">new</span> View.OnClickListener() &#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View v)</span> </span>&#123;</span><br><span class="line">        Message m = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">if</span> (v == mButtonPositive &amp;&amp; mButtonPositiveMessage != <span class="keyword">null</span>) &#123;</span><br><span class="line">            m = Message.obtain(mButtonPositiveMessage);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (v == mButtonNegative &amp;&amp; mButtonNegativeMessage != <span class="keyword">null</span>) &#123;</span><br><span class="line">            m = Message.obtain(mButtonNegativeMessage);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (v == mButtonNeutral &amp;&amp; mButtonNeutralMessage != <span class="keyword">null</span>) &#123;</span><br><span class="line">            m = Message.obtain(mButtonNeutralMessage);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (m != <span class="keyword">null</span>) &#123;</span><br><span class="line">            m.sendToTarget();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Post a message so we dismiss after the above handlers are executed</span></span><br><span class="line">        mHandler.obtainMessage(ButtonHandler.MSG_DISMISS_DIALOG, mDialogInterface)</span><br><span class="line">                .sendToTarget();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>
<p>这段代码的前几行用来触发对话框中的三个按钮，而在最后的代码就是通过mHandler来关闭对话框的。</p>
<p><strong>总结</strong><br>总结对话框单击事件的处理过程：在AlertController类处理对话框按钮时会为每个按钮添加一个onClick事件，而这个事件的实例就是上面的mButtonHandler，在这个实例中会通过发消息的方式调用为按钮设置的单击事件，在触发完按钮的单击事件后，会通过发消息的方式调用dismiss()来关闭对话框，这就是没有调用dismiss()点击取消或者确定按钮对话框都会自动关闭的原因。</p>
<h2 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h2><ol>
<li>使用我们自己的Hanlder对象来替换掉ButtonHandler就可以阻止AlertDialog调用dismiss()关闭对话框。</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">MyButtonHandler</span> <span class="keyword">extends</span> <span class="title">Handler</span></span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">private</span> WeakReference&lt;DialogInterface&gt; mDialog;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">MyButtonHandler</span><span class="params">(Dialog dialog)</span> </span>&#123;</span><br><span class="line">		mDialog = <span class="keyword">new</span> WeakReference&lt;DialogInterface&gt;(dialog);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handleMessage</span><span class="params">(Message msg)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">switch</span> (msg.what) &#123;</span><br><span class="line">		<span class="keyword">case</span> DialogInterface.BUTTON_POSITIVE:</span><br><span class="line">		<span class="keyword">case</span> DialogInterface.BUTTON_NEGATIVE:</span><br><span class="line">		<span class="keyword">case</span> DialogInterface.BUTTON_NEUTRAL:</span><br><span class="line">			((DialogInterface.OnClickListener)msg.obj).onClick(mDialog.get(), msg.what);</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">default</span>:</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>上面自定义的Handler类和源代码相比只去掉了最后一个case语句。<br>然后在dialog调用show()方法之前为AlertController类的mHandler变量重新赋值。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 通过获取字段，然后设定setAccessible为true，即可访问私有变量</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	Field field = dialog.getClass().getDeclaredField(<span class="string">"mAlert"</span>);</span><br><span class="line">	field.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">		</span><br><span class="line">	Object obj = field.get(dialog);</span><br><span class="line">	field = obj.getClass().getDeclaredField(<span class="string">"mHandler"</span>);</span><br><span class="line">	field.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">	field.set(obj, <span class="keyword">new</span> MyButtonHandler(dialog));</span><br><span class="line">&#125; <span class="keyword">catch</span> (NoSuchFieldException e) &#123;</span><br><span class="line">	e.printStackTrace();</span><br><span class="line">&#125; <span class="keyword">catch</span> (IllegalAccessException e) &#123;</span><br><span class="line">	e.printStackTrace();</span><br><span class="line">&#125; <span class="keyword">catch</span> (IllegalArgumentException e) &#123;</span><br><span class="line">	e.printStackTrace();</span><br><span class="line">&#125;</span><br><span class="line">dialog.show();</span><br></pre></td></tr></table></figure></p>
<ol start="2">
<li>从dismiss()方法上做手脚解决。我们可以先看一下dismiss()的代码：</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">dismiss</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (Looper.myLooper() == mHandler.getLooper()) &#123;</span><br><span class="line">        dismissDialog();</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        mHandler.post(mDismissAction);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dismissDialog</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (mDecor == <span class="keyword">null</span> || !mShowing) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (mWindow.isDestroyed()) &#123;</span><br><span class="line">        Log.e(TAG, <span class="string">"Tried to dismissDialog() but the Dialog's window was already destroyed!"</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        mWindowManager.removeViewImmediate(mDecor);</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (mActionMode != <span class="keyword">null</span>) &#123;</span><br><span class="line">            mActionMode.finish();</span><br><span class="line">        &#125;</span><br><span class="line">        mDecor = <span class="keyword">null</span>;</span><br><span class="line">        mWindow.closeAllPanels();</span><br><span class="line">        onStop();</span><br><span class="line">        mShowing = <span class="keyword">false</span>;</span><br><span class="line"></span><br><span class="line">        sendDismissMessage();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在dismissDialog()内部会先判断对话框是否关闭(对应mShowing标识位)，所以我们可以在代码中设置这个值，使系统认为对话框已经关闭。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">	Field field = dialog.getClass().getSuperclass().getDeclaredField(<span class="string">"mShowing"</span>);</span><br><span class="line">	field.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">	field.set(dialog, <span class="keyword">false</span>);</span><br><span class="line">	dialog.dismiss();</span><br><span class="line">&#125; <span class="keyword">catch</span> (NoSuchFieldException e) &#123;</span><br><span class="line">	e.printStackTrace();</span><br><span class="line">&#125; <span class="keyword">catch</span> (IllegalAccessException e) &#123;</span><br><span class="line">	e.printStackTrace();</span><br><span class="line">&#125; <span class="keyword">catch</span> (IllegalArgumentException e) &#123;</span><br><span class="line">	e.printStackTrace();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/04/01/1.1 Activity的LaunchMode/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Forwards">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Forwards">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/04/01/1.1 Activity的LaunchMode/" itemprop="url">Activity的启动模式</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-04-01T15:25:54+08:00">
                2018-04-01
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>本文结构：<br><img src="http://pcmve13p6.bkt.clouddn.com/static/images/ActivityLaunchMode.png"></p>
<p>前言：介绍Activity的启动模式之前先介绍一下任务栈。任务栈是一个“后进先出”的栈结构，每按一下back键就有一个Activity出栈，直到栈空为止，当栈中无任何Activity的时候，系统就会回收这个任务栈。</p>
<h2 id="1-1-Activity的LaunchMode"><a href="#1-1-Activity的LaunchMode" class="headerlink" title="1.1 Activity的LaunchMode"></a>1.1 Activity的LaunchMode</h2><p>Activity的LaunchMode目前有四种启动模式：standard、singleTop、singleTask以及singleInstance。</p>
<ol>
<li>standard：标准模式，也是系统的默认模式。每次启动一个Activity都会重新创建一个新的实例，不管这个实例是否已经存在。这种模式是典型的多实例实现，一个任务栈中可以有多个实例，每个实例也可以属于不同的任务栈。在这种模式下，谁启动了这个Activity，那么这个Activity就运行在启动它的那个Activity的所在的栈中。</li>
</ol>
<p>注意：当我们用ApplicationContext去启动standard模式的Activity的时候就会报错，log如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">...Calling startActivity from outside of an Activity context <span class="keyword">requires</span> the FLAG_ACTIVITY_NEW_TASK flag....</span><br></pre></td></tr></table></figure>
<p>这是因为standard模式下的Activity默认会进入启动它的Activity所属的任务栈中，但是由于非Activity类型的context并没有任务栈，所以解决这个问题的办法是为待启动Activity指定FLAG_ACTIVITY_NEW_TASK标记位。这个时候待启动Activity实际上是以singleTask模式启动的。</p>
<ol start="2">
<li>singleTop：栈顶复用模式。在这种模式下，如果新Activity已经位于任务栈的栈顶，那么此Activity不会被重新创建，同时它的onNewIntent方法会被回调，通过此方法的参数我们就可以取出当前请求的信息；如果新Activity的实例已经存在但不是位于栈顶，那么新Activity会被重新创建。</li>
<li>singleTask：栈内复用模式。这是一种单实例模式，在这种模式下，只要Activity在一个栈中存在，那么多次启动这个Activity都不会重新创建实例，同时系统会回调其onNewIntent。具体一点，当一个具有singleTask模式的Activity请求启动后，系统会首先寻找是否存在<strong>这个Activity想要的任务栈</strong>，如果不存在，就重新创建一个任务栈，然后创建这个Activity的实例后把这个Activity放入栈中，如果存在，这是要看这个Activity是否在栈中有实例存在，如果有实例存在，那么系统会把这个Activity调到栈顶并调用它的onNewIntent，如果实例不存在，就创建这个Activity的实例并将其压入栈中。<br>例子：如果D所需的任务栈为S1，并且当前S1的情况为ADBC，根据栈内复用原则，此时D不会被重新创建，系统会把D切换到栈顶并调用其onNewIntent，同时由于singleTask默认默认具有clearTop的效果，会导致栈内所有在D上面的Activity全部出栈，最终S1中的情况为AD。</li>
<li>singleInstance：单实例模式，加强版的singleTask模式，它除了具有singleTask的所有特性外，还加强了一点，那就是此模式下的Activity只能单独的位于一个任务栈中。</li>
</ol>
<p>什么是Activity所需要的任务栈？这要从一个参数说起：TaskAffinity，任务相关性。这个参数标识了一个Activity所需要的任务栈的名字，默认情况下所有Activity所需的任务栈的名字为应用的包名，但是我们可以为每个Activity都单独指定TaskAffinity属性，这个属性值不能和包名一样，否则就相当于没有指定。TaskAffinity属性主要和singleTask启动模式和allowTaskReparenting属性配对使用，在其他情况下没有意义。</p>
<h2 id="1-2-如何给Activity指定启动模式"><a href="#1-2-如何给Activity指定启动模式" class="headerlink" title="1.2 如何给Activity指定启动模式"></a>1.2 如何给Activity指定启动模式</h2><ol>
<li><p>通过AndroidMenifest为Activity指定启动模式。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;activity</span><br><span class="line">	android:name=<span class="string">"com.my.test.TestActivity"</span></span><br><span class="line">	android:launchMode=<span class="string">"singleTask"</span></span><br><span class="line">	android:label=<span class="string">"@string/app_name"</span>&gt;</span><br><span class="line">&lt;/activity&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>通过在Intent设置标志位来为Activity指定启动模式</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Intent intent = <span class="keyword">new</span> Intent(<span class="keyword">this</span>, TestActivity.class);</span><br><span class="line">intent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);</span><br><span class="line">startActivity(intent);</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>二者区别：首先，优先级上第二种高于第一种，当两种同时存在时，以第二种为准；其次，二者在限定范围上有所不同。</p>
<h2 id="1-3-Activity的Flags"><a href="#1-3-Activity的Flags" class="headerlink" title="1.3 Activity的Flags"></a>1.3 Activity的Flags</h2><ol>
<li>FLAG_ACTIVITY_NEW_TASK：这个标记位的作用是为Activity指定“singleTask”启动模式。</li>
<li>FLAG_ACTIVITY_SINGLE_TOP：这个标记位的作用是为Activity指定“singleTop”启动模式。</li>
<li>FLAG_ACTIVITY_CLEAR_TOP：具有此标记位的Activity，当它启动时，在同一个任务栈中所有位于它上面的Activity都要出栈，这个标记位一般和singleTask启动模式一起出现。在这种情况下，如果被启动的实例已经存在，那么系统会调用它的onNewIntent。</li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">Forwards</p>
              <p class="site-description motion-element" itemprop="description">Keep coding</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">21</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            

            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Forwards</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Mist</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
